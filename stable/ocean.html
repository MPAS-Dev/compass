

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>COMPASS for ocean test case &mdash; COMPASS stable documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Ocean Test Cases" href="ocean_testcases/index.html" />
    <link rel="prev" title="manage_regression_suite.py" href="manage_regression_suite.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> COMPASS
          

          
          </a>

          
            
            
              <div class="version">
                stable
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="details.html">Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts.html">Scripts</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">COMPASS for ocean test case</a></li>
<li class="toctree-l1"><a class="reference internal" href="ocean_testcases/index.html">Ocean Test Cases</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">COMPASS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>COMPASS for ocean test case</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/ocean.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="compass-for-ocean-test-case">
<span id="compass-ocean"></span><h1>COMPASS for ocean test case<a class="headerlink" href="#compass-for-ocean-test-case" title="Permalink to this headline">¶</a></h1>
<div class="section" id="compass-conda-environment">
<h2>COMPASS conda environment<a class="headerlink" href="#compass-conda-environment" title="Permalink to this headline">¶</a></h2>
<p>To set up and run ocean test cases from COMPASS, you will need a conda
environment.  First, install Miniconda3 (if miniconda is not already
installed), then create a new conda environment as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">create</span> <span class="o">-</span><span class="n">n</span> <span class="n">compass_0</span><span class="o">.</span><span class="mf">1.2</span> <span class="o">-</span><span class="n">c</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span> <span class="o">-</span><span class="n">c</span> <span class="n">e3sm</span> <span class="n">python</span><span class="o">=</span><span class="mf">3.7</span> <span class="n">compass</span><span class="o">=</span><span class="mf">0.1</span><span class="o">.</span><span class="mi">2</span>
</pre></div>
</div>
<p>Each time you want to work with COMPASS, you will need to run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">activate</span> <span class="n">compass_0</span><span class="o">.</span><span class="mf">1.2</span>
</pre></div>
</div>
<p>An appropriate conda environment is already available on Los Alamos National
Laboratory’s Institutional Computing (LANL IC) machines as well as Anvil, Compy
and Cori.  In each case, you will run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">&lt;</span><span class="n">base_path</span><span class="o">&gt;/</span><span class="n">load_latest_compass</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Values of <code class="docutils literal notranslate"><span class="pre">&lt;base_path&gt;</span></code> are:</p>
<blockquote>
<div><ul class="simple">
<li><p>grizzly and badger - <code class="docutils literal notranslate"><span class="pre">/usr/projects/climate/SHARED_CLIMATE/anaconda_envs</span></code></p></li>
<li><p>anvil (blues) - <code class="docutils literal notranslate"><span class="pre">/lcrc/soft/climate/e3sm-unified/</span></code></p></li>
<li><p>compy - <code class="docutils literal notranslate"><span class="pre">/share/apps/E3SM/conda_envs</span></code></p></li>
<li><p>cori - <code class="docutils literal notranslate"><span class="pre">/global/cfs/cdirs/acme/software/anaconda_envs</span></code></p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="setting-config-options">
<h2>Setting config options<a class="headerlink" href="#setting-config-options" title="Permalink to this headline">¶</a></h2>
<p>The file <code class="docutils literal notranslate"><span class="pre">general.config.ocean</span></code> is a template containing a set of config
options that the COMPASS user must set in order to set up ocean test cases.
Make a copy of this file (e.g. <code class="docutils literal notranslate"><span class="pre">config.ocean</span></code>) and set the options as follows.
In six places, replace <code class="docutils literal notranslate"><span class="pre">FULL_PATH_TO_MPAS_MODEL_REPO</span></code> with the path where you
have checked out (and built) the branch of MPAS-Model you are planning to use.
Five other paths are required, as explained below.</p>
</div>
<div class="section" id="mesh-database-initial-condition-database-and-bathymetry-database">
<h2>mesh_database, initial_condition_database and bathymetry_database<a class="headerlink" href="#mesh-database-initial-condition-database-and-bathymetry-database" title="Permalink to this headline">¶</a></h2>
<p>These are directories for storing pre-generated mesh files, data sets for
creating initial conditions, and bathymetry data. These can be empty directories, in which case
meshes and other data sets will be downloaded as required during test-case
setup.  (If a test case appears to hang during setup, it is most likely
downloading mesh, initial-condition or bathymetry data.)</p>
<p>On LANL IC, the shared data bases can be found at:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mesh_database</span> <span class="o">=</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="n">regionalclimate</span><span class="o">/</span><span class="n">COMMON_MPAS</span><span class="o">/</span><span class="n">ocean</span><span class="o">/</span><span class="n">grids</span><span class="o">/</span><span class="n">mesh_database</span>
<span class="n">initial_condition_database</span> <span class="o">=</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="n">regionalclimate</span><span class="o">/</span><span class="n">COMMON_MPAS</span><span class="o">/</span><span class="n">ocean</span><span class="o">/</span><span class="n">grids</span><span class="o">/</span><span class="n">initial_condition_database</span>
<span class="n">bathymetry_database</span> <span class="o">=</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="n">regionalclimate</span><span class="o">/</span><span class="n">COMMON_MPAS</span><span class="o">/</span><span class="n">ocean</span><span class="o">/</span><span class="n">grids</span><span class="o">/</span><span class="n">bathymetry_database</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ocean_testcases/index.html" class="btn btn-neutral float-right" title="Ocean Test Cases" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="manage_regression_suite.html" class="btn btn-neutral float-left" title="manage_regression_suite.py" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright Copyright (c) 2013-2020,  Los Alamos National Security, LLC (LANS) (Ocean: LA-CC-13-047;Land Ice: LA-CC-13-117) and the University Corporation for Atmospheric Research (UCAR).

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>