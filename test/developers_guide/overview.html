

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Overview &mdash; compass 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Command-line interface" href="command_line.html" />
    <link rel="prev" title="Personal OSX Machine" href="../users_guide/machines/osx.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> compass
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User's guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../users_guide/overview.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users_guide/testcase.html">Test Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users_guide/configuration.html">Configuration Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users_guide/suite.html">Test Suites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users_guide/landice/index.html">Landice core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users_guide/ocean/index.html">Ocean core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users_guide/machines/index.html">Machines</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer's guide</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#packages-and-modules">Packages and Modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#packages">Packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="#modules">Modules</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#code-sharing">Code sharing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#in-compass-framework">In compass framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="#within-a-core">Within a core</a></li>
<li class="toctree-l3"><a class="reference internal" href="#within-a-configuration">Within a configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#within-a-test-case">Within a test case</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#dictionaries-not-classes">Dictionaries not classes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="command_line.html">Command-line interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="cores.html">Cores</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/index.html">Examples core</a></li>
<li class="toctree-l1"><a class="reference internal" href="ocean/index.html">Ocean core</a></li>
<li class="toctree-l1"><a class="reference internal" href="framework.html">Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="docs.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="building_docs.html">Building the Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API reference</a></li>
</ul>
<p class="caption"><span class="caption-text">Versions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../versions.html">Code and Documentation Versions</a></li>
</ul>
<p class="caption"><span class="caption-text">Legacy User's guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../legacy/users_guide/overview.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../legacy/users_guide/scripts.html">Scripts</a></li>
</ul>
<p class="caption"><span class="caption-text">Legacy Ocean Test Cases</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../legacy/ocean/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../legacy/ocean/test_cases/index.html">Ocean test cases</a></li>
</ul>
<p class="caption"><span class="caption-text">Legacy Instructions for Machines</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../legacy/machine_specific_instructions/slurm.html">Slurm job queueing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../legacy/machine_specific_instructions/lanl.html">LANL Institutional Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../legacy/machine_specific_instructions/nersc.html">NERSC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../legacy/machine_specific_instructions/anvil.html">Anvil/Blues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../legacy/machine_specific_instructions/linux.html">Personal Linux/OSX Machine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../legacy/machine_specific_instructions/osx.html">Personal OSX Machine</a></li>
</ul>
<p class="caption"><span class="caption-text">Legacy Developer's guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../legacy/developers_guide/config.html">config</a></li>
<li class="toctree-l1"><a class="reference internal" href="../legacy/developers_guide/driver_script.html">driver_script</a></li>
<li class="toctree-l1"><a class="reference internal" href="../legacy/developers_guide/template.html">template</a></li>
<li class="toctree-l1"><a class="reference internal" href="../legacy/developers_guide/regression_suite.html">regression_suite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../legacy/developers_guide/run_config.html">run_config</a></li>
<li class="toctree-l1"><a class="reference internal" href="../legacy/developers_guide/building_docs.html">Building the Documentation</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">compass</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Overview</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/developers_guide/overview.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="overview">
<span id="dev-overview"></span><h1>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">compass</span></code> is a <a class="reference external" href="https://docs.python.org/3/tutorial/modules.html#packages">python package</a>.
All of the code in the package can be accessed in one of two ways.  The first
is the command-line interface with commands like <a class="reference internal" href="command_line.html#dev-compass-list"><span class="std std-ref">compass list</span></a> and
<a class="reference internal" href="command_line.html#dev-compass-setup"><span class="std std-ref">compass setup</span></a>.  The second way is through import commands like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">compass.io</span> <span class="kn">import</span> <span class="n">symlink</span>


<span class="n">symlink</span><span class="p">(</span><span class="s1">&#39;../initial_condition/initial_condition.nc&#39;</span><span class="p">,</span> <span class="s1">&#39;init.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Before we dig into the details of now to develop new test cases and other
infrastructure for <code class="docutils literal notranslate"><span class="pre">compass</span></code>, we first give a little bit of background on
the design philosophy behind the package.</p>
<div class="section" id="packages-and-modules">
<span id="dev-packages"></span><h2>Packages and Modules<a class="headerlink" href="#packages-and-modules" title="Permalink to this headline">¶</a></h2>
<p>Why a python package?  That sounds complicated.</p>
<p>Some of the main advantages of <code class="docutils literal notranslate"><span class="pre">compass</span></code> being a package instead of a group
of scripts (as was the case for <a class="reference internal" href="../index.html#legacy-compass"><span class="std std-ref">Legacy COMPASS</span></a>) are that:</p>
<ol class="arabic simple">
<li><p>it is a lot easier to share code between test cases;</p></li>
<li><p>there is no need to create symlinks to individual scripts or use
<a class="reference external" href="https://docs.python.org/3/library/subprocess.html">subprocess</a> calls to
run one python script from within another;</p></li>
<li><p>functions within <code class="docutils literal notranslate"><span class="pre">compass</span></code> modules and subpackages have relatively simple
interfaces that are easier to document and understand that the arguments
passed in to a script; and</p></li>
<li><p>releases of the <code class="docutils literal notranslate"><span class="pre">compass</span></code> package will make it easy for developers of
other python packages and scripts to use our code.</p></li>
</ol>
<p>This documentation won’t try to provide a whole tutorial on python packages and
modules but we know most developers won’t be too clued in on these concepts so
here’s a short intro.</p>
<div class="section" id="packages">
<h3>Packages<a class="headerlink" href="#packages" title="Permalink to this headline">¶</a></h3>
<p>A python package is a directory that has a file called <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code>.  That
file can be empty or it can have code in it.  If it has functions inside of
it, those functions act like they’re directly in the package.  As an example,
the compass file
<a class="reference external" href="https://github.com/MPAS-Dev/compass/tree/master/compass/testcase/__init__.py">compass/testcase/__init__.py</a>
has a function <a class="reference internal" href="generated/compass.testcase.get_step_default.html#compass.testcase.get_step_default" title="compass.testcase.get_step_default"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.testcase.get_step_default()</span></code></a> that looks like
this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_step_default</span><span class="p">(</span><span class="n">module</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">module</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">step</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;module&#39;</span><span class="p">:</span> <span class="n">module</span><span class="p">,</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
            <span class="s1">&#39;subdir&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
            <span class="s1">&#39;setup&#39;</span><span class="p">:</span> <span class="s1">&#39;setup&#39;</span><span class="p">,</span>
            <span class="s1">&#39;run&#39;</span><span class="p">:</span> <span class="s1">&#39;run&#39;</span><span class="p">,</span>
            <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;outputs&#39;</span><span class="p">:</span> <span class="p">[]}</span>
    <span class="k">return</span> <span class="n">step</span>
</pre></div>
</div>
<p>The details aren’t important.  The point is that the function can be imported
like so:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">compass.testcase</span> <span class="kn">import</span> <span class="n">get_step_default</span>


<span class="n">step</span> <span class="o">=</span> <span class="n">get_step_default</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</pre></div>
</div>
<p>So you don’t ever refer to <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code>, it’s like a hidden shortcut so the
its contents can be referenced with just the subdirectory (package) name.</p>
<p>A package can contain other packages and modules (we’ll discuss these in just
a second).  For example, the <code class="docutils literal notranslate"><span class="pre">testcase</span></code> package mentioned above is inside the
<code class="docutils literal notranslate"><span class="pre">compass</span></code> package.  The sequence of dots in the import is how you find your
way from the root (<code class="docutils literal notranslate"><span class="pre">compass</span></code> for this package) into subpackages and modules.
It’s similar to the <code class="docutils literal notranslate"><span class="pre">/</span></code> characters in a unix directory.</p>
</div>
<div class="section" id="modules">
<h3>Modules<a class="headerlink" href="#modules" title="Permalink to this headline">¶</a></h3>
<p>Modules are just python files that aren’t scripts.  Since you can often treat
scripts like modules, even that distinction isn’t that exact.  But for the
purposes of the <code class="docutils literal notranslate"><span class="pre">compass</span></code> package, every single file ending in <code class="docutils literal notranslate"><span class="pre">.py</span></code> in the
<code class="docutils literal notranslate"><span class="pre">compass</span></code> package is a module (except maybe the <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code>, not sure
about those…).</p>
<p>As an exmaple, the <code class="docutils literal notranslate"><span class="pre">compass</span></code> package contains a module <code class="docutils literal notranslate"><span class="pre">testcases.py</span></code> (a
little confusing, since there’s a <code class="docutils literal notranslate"><span class="pre">testcase</span></code> package too, but trust us for
now that there’s a good reason for this).  There’s a function
<a class="reference internal" href="generated/compass.testcases.collect.html#compass.testcases.collect" title="compass.testcases.collect"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.testcases.collect()</span></code></a> in that module:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">collect</span><span class="p">():</span>

<span class="n">testcase_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

<span class="k">for</span> <span class="n">tests</span> <span class="ow">in</span> <span class="p">[</span><span class="n">example_tests</span><span class="p">,</span> <span class="n">ocean_tests</span><span class="p">]:</span>
    <span class="n">testcase_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">tests</span><span class="o">.</span><span class="n">collect</span><span class="p">())</span>

<span class="n">validate</span><span class="p">(</span><span class="n">testcase_list</span><span class="p">)</span>

<span class="o">...</span>

<span class="k">return</span> <span class="n">testcases</span>
</pre></div>
</div>
<p>Don’t worry about the details, the point is that you would import this function
just like in the package example above:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">compass.testcases</span> <span class="kn">import</span> <span class="n">collect</span>


<span class="n">testcases</span> <span class="o">=</span> <span class="n">collect</span><span class="p">()</span>
</pre></div>
</div>
<p>So a module named <code class="docutils literal notranslate"><span class="pre">foo.py</span></code> and a package in a directory named <code class="docutils literal notranslate"><span class="pre">foo</span></code> with
and <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file look exactly the same when you import them.</p>
<p>So why choose one over the other?</p>
<p>The main reason to go with a package over a module is if you need to include
other files (such as other modules and packages, but also other things like
<a class="reference internal" href="../users_guide/configuration.html#config-files"><span class="std std-ref">Configuration Files</span></a>, <a class="reference internal" href="framework.html#dev-namelist"><span class="std std-ref">Namelist</span></a>, or <a class="reference internal" href="framework.html#dev-streams"><span class="std std-ref">Streams</span></a> files).  It’s
always pretty easy to make a module into a package (by making a directory with
the name of the package, moving the module in, an renaming it <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code>)
or visa versa (by renaming <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> to the module name, moving it up
a directory, and deleting the subdirectory).</p>
</div>
</div>
<div class="section" id="code-sharing">
<span id="dev-code-sharing"></span><h2>Code sharing<a class="headerlink" href="#code-sharing" title="Permalink to this headline">¶</a></h2>
<p>Very nearly all of the code in <a class="reference internal" href="../index.html#legacy-compass"><span class="std std-ref">Legacy COMPASS</span></a> was in the form of python
scripts.  A significant amount of external code was also in this form.  A test
case was composed of XML files, and python scripts parsed these XML files to
produce other python scripts to run the test case.  These scripts were dense.
The XML files had a unique syntax that made the learning curve for
<a class="reference internal" href="../index.html#legacy-compass"><span class="std std-ref">Legacy COMPASS</span></a> pretty high.  Errors in syntax were often hard to
understand because the script-generating scripts were difficult to read and
understand.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">compass</span></code> package endeavors to increase code readability and code sharing
in a number of ways.</p>
<div class="section" id="in-compass-framework">
<h3>In compass framework<a class="headerlink" href="#in-compass-framework" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">compass</span></code> framework (modules and packages not in the core-specific
packages) has a lot of code that is shared across existing test cases and could
be very useful for future ones.</p>
<p>Most of the framework currently has roughly the same functionality as
<a class="reference internal" href="../index.html#legacy-compass"><span class="std std-ref">Legacy COMPASS</span></a>, but it has been broken into more modules that make it
clear what functionality each contains, e.g. <code class="docutils literal notranslate"><span class="pre">compass.namelists</span></code> and
<code class="docutils literal notranslate"><span class="pre">compass.streams</span></code> are for manipulating <a class="reference internal" href="framework.html#dev-namelist"><span class="std std-ref">Namelist</span></a> and
<a class="reference internal" href="framework.html#dev-streams"><span class="std std-ref">Streams</span></a> files, respectively; <code class="docutils literal notranslate"><span class="pre">compass.io</span></code> has functionality for
downloading files from the
<a class="reference external" href="https://web.lcrc.anl.gov/public/e3sm/mpas_standalonedata/">LCRC server</a>
and creating symlinks; and <code class="docutils literal notranslate"><span class="pre">compass.validation</span></code> can be used to ensure that
variables are bit-for-bit identical between steps or when compared with a
baseline, and to compare timers with a baseline.  This functionality was all
included in 4 very long scripts in <a class="reference internal" href="../index.html#legacy-compass"><span class="std std-ref">Legacy COMPASS</span></a>.</p>
<p>One example that doesn’t have a clear analog in <a class="reference internal" href="../index.html#legacy-compass"><span class="std std-ref">Legacy COMPASS</span></a> is the
<code class="docutils literal notranslate"><span class="pre">compass.parallel</span></code> module.  It contains two functions:
<a class="reference internal" href="generated/compass.parallel.get_available_cores_and_nodes.html#compass.parallel.get_available_cores_and_nodes" title="compass.parallel.get_available_cores_and_nodes"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.parallel.get_available_cores_and_nodes()</span></code></a>, which can find out
the number of total cores and nodes available for running steps, and
<a class="reference internal" href="generated/compass.parallel.update_namelist_pio.html#compass.parallel.update_namelist_pio" title="compass.parallel.update_namelist_pio"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.parallel.update_namelist_pio()</span></code></a>, which updates the number of
PIO tasks and the stride between tasks based on the number of cores that a step
is actually running with.</p>
</div>
<div class="section" id="within-a-core">
<h3>Within a core<a class="headerlink" href="#within-a-core" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../index.html#legacy-compass"><span class="std std-ref">Legacy COMPASS</span></a> shares functionality with a core by having scripts at the
core level that are linked within test cases and which take command-line
arguments that function roughly the same way as function arguments.  But these
scripts are not able to share any code between them unless it is from
<code class="docutils literal notranslate"><span class="pre">mpas_tools</span></code> or another external package.</p>
<p>A core in <code class="docutils literal notranslate"><span class="pre">compass</span></code> could, theoretically, build out functionality as complex
as in MPAS-Model if desired.  This has already been accomplished for the 3
idealized test cases included in <code class="docutils literal notranslate"><span class="pre">compass</span></code>.</p>
<p>The shared functionality in the <a class="reference internal" href="ocean/index.html#dev-ocean"><span class="std std-ref">Ocean core</span></a> is described in
<a class="reference internal" href="ocean/framework.html#dev-ocean-framework"><span class="std std-ref">Ocean framework</span></a>.</p>
</div>
<div class="section" id="within-a-configuration">
<h3>Within a configuration<a class="headerlink" href="#within-a-configuration" title="Permalink to this headline">¶</a></h3>
<p>So far, the most common type of shared code within configurations are modules
defining steps that are used in multiple test cases.  For example, the
<a class="reference internal" href="ocean/configurations/baroclinic_channel.html#dev-ocean-baroclinic-channel"><span class="std std-ref">baroclinic_channel</span></a> configuration uses shared modules to define
the <code class="docutils literal notranslate"><span class="pre">initial_state</span></code> and <code class="docutils literal notranslate"><span class="pre">forward</span></code> steps of each test case.  Configurations
also often include namelist and streams files with replacements to use across
test cases.</p>
<p>In addition to shared steps, the <a class="reference internal" href="ocean/configurations/global_ocean.html#dev-ocean-global-ocean"><span class="std std-ref">global_ocean</span></a> configuration
includes some additional shared framework described in
<a class="reference internal" href="ocean/configurations/global_ocean.html#dev-ocean-global-ocean-framework"><span class="std std-ref">Framework</span></a>.</p>
<p>The shared code in <code class="docutils literal notranslate"><span class="pre">global_ocean</span></code> has made it easy to define 138 different
test cases using the QU240 (or QUwISC240) mesh.  This is possible because
the same conceptual test (e.g. restart) can be defined:</p>
<blockquote>
<div><ul class="simple">
<li><p>with or without ice-shelf cavities</p></li>
<li><p>with the PHC or EN4 1900 initial conditions</p></li>
<li><p>with or without BGC support</p></li>
<li><p>with the RK4 or split-explicit time integrators</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="within-a-test-case">
<h3>Within a test case<a class="headerlink" href="#within-a-test-case" title="Permalink to this headline">¶</a></h3>
<p>The main way code is currently reused with a test case is when the same module
for a step gets used multiple times within a test case.  For example,
the <a class="reference internal" href="ocean/configurations/baroclinic_channel.html#dev-ocean-baroclinic-channel-rpe-test"><span class="std std-ref">rpe_test</span></a> test case uses the same
forward run with 5 different values of the viscosity.</p>
</div>
</div>
<div class="section" id="dictionaries-not-classes">
<span id="dev-dicts-not-classes"></span><h2>Dictionaries not classes<a class="headerlink" href="#dictionaries-not-classes" title="Permalink to this headline">¶</a></h2>
<p>In the process of developing
<a class="reference external" href="https://github.com/MPAS-Dev/MPAS-Analysis/">MPAS-Analysis</a>, we found that
many of our developers were not very comfortable with
<a class="reference external" href="https://docs.python.org/3/tutorial/classes.html">classes</a>, methods,
<a class="reference external" href="https://docs.python.org/3/tutorial/classes.html#inheritance">inheritance</a>
and other concepts related to
<a class="reference external" href="https://en.wikipedia.org/wiki/Object-oriented_programming">object-oriented programming</a>.
In MPAS-Analysis, tasks are implemented as classes to make it easier to use
python’s <a class="reference external" href="https://docs.python.org/3/library/multiprocessing.html">multiprocessing</a>
capability.  In practice, this led to code that was complex enough that only
a handful of developers felt comfortable contributing directly to the code.</p>
<p>Since we would like developers to feel comfortable contributing new test cases
to <code class="docutils literal notranslate"><span class="pre">compass</span></code> even if they are relatively new to python, we decided not to
use classes here.  But we did need a data structure to represent all of the
data associated with a test case and another for a step.  We settled on
<a class="reference external" href="https://docs.python.org/3/tutorial/datastructures.html#dictionaries">python dictionaries</a>
as the simplest data structure for storing this data.</p>
<p>You can take a look at the <a class="reference internal" href="cores.html#dev-testcase-dict"><span class="std std-ref">testcase dictionary</span></a> and <a class="reference internal" href="cores.html#dev-step-dict"><span class="std std-ref">step dictionary</span></a>
for a full listing of the typical entries in these dictionaries. Some entries
are required for the compass <a class="reference internal" href="framework.html#dev-framework"><span class="std std-ref">Framework</span></a> to work properly.  Others
are used to keep track of parameters of a test case or step that the user
should not alter and therefore that should not be in the <a class="reference internal" href="../users_guide/configuration.html#config-files"><span class="std std-ref">Configuration Files</span></a>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="command_line.html" class="btn btn-neutral float-right" title="Command-line interface" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../users_guide/machines/osx.html" class="btn btn-neutral float-left" title="Personal OSX Machine" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright Copyright (c) 2013-2021,  Los Alamos National Security, LLC (LANS) (Ocean: LA-CC-13-047;Land Ice: LA-CC-13-117) and the University Corporation for Atmospheric Research (UCAR)..

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>