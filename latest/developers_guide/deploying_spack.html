

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Deploying a new spack environment &mdash; compass latest documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=c6e86fd7"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="API reference" href="api.html" />
    <link rel="prev" title="Building the Documentation" href="building_docs.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            compass
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User's guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../users_guide/quick_start.html">Quick Start for Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users_guide/test_cases.html">Test Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users_guide/config_files.html">Config Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users_guide/test_suites.html">Test Suites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users_guide/landice/index.html">Landice core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users_guide/ocean/index.html">Ocean core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users_guide/machines/index.html">Machines</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer's guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quick_start.html">Quick Start for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_line.html">Command-line interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="organization.html">Organization of Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="landice/index.html">Landice core</a></li>
<li class="toctree-l1"><a class="reference internal" href="ocean/index.html">Ocean core</a></li>
<li class="toctree-l1"><a class="reference internal" href="framework.html">Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="machines/index.html">Machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="docs.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="building_docs.html">Building the Documentation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Deploying a new spack environment</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#where-do-we-update-compass-dependencies">Where do we update compass dependencies?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mache">Mache</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spack">Spack</a></li>
<li class="toctree-l3"><a class="reference internal" href="#conda">Conda</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id1">Mache</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#identifying-e3sm-machines">Identifying E3SM machines</a></li>
<li class="toctree-l3"><a class="reference internal" href="#config-options-describing-e3sm-machines">Config options describing E3SM machines</a></li>
<li class="toctree-l3"><a class="reference internal" href="#modules-env-variables-etc-for-e3sm-machines">Modules, env. variables, etc. for  E3SM machines</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mirroring-moab-on-chicoma">Mirroring MOAB on Chicoma</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creating-spack-environments">Creating spack environments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#updating-spack-from-compass-with-mache-from-a-remote-branch">Updating spack from compass with mache from a remote branch</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#testing-spack-with-petsc-and-netlib-lapack">Testing spack with PETSc (and Netlib LAPACK)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#testing-spack-with-albany">Testing spack with Albany</a></li>
<li class="toctree-l3"><a class="reference internal" href="#troubleshooting-spack">Troubleshooting spack</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#testing-compass">Testing compass</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#testing-mpas-ocean-without-petsc">Testing MPAS-Ocean without PETSc</a></li>
<li class="toctree-l3"><a class="reference internal" href="#testing-mali-with-albany">Testing MALI with Albany</a></li>
<li class="toctree-l3"><a class="reference internal" href="#testing-mpas-ocean-with-petsc">Testing MPAS-Ocean with PETSc</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#deploying-shared-spack-environments">Deploying shared spack environments</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#deploy-spack-for-compass-without-albany-or-petsc">Deploy spack for compass without Albany or PETSc</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deploying-spack-with-albany">Deploying spack with Albany</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deploying-spack-with-petsc-and-netlib-lapack">Deploying spack with PETSc (and Netlib LAPACK)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../design_docs/index.html">Design Documents</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/dev_add_test_group.html">Developer Tutorial: Adding a new test group</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/dev_add_rrm.html">Developer Tutorial: Adding a new ocean/sea ice regionally refined mesh (RRM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/dev_add_param_study.html">Developer Tutorial: Adding a parameter study</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/dev_porting_legacy.html">Developer Tutorial: Porting a legacy COMPASS test group</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Glossary</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Versions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../versions.html">Code and Documentation Versions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">compass</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Deploying a new spack environment</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/developers_guide/deploying_spack.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="deploying-a-new-spack-environment">
<span id="dev-deploying-spack"></span><h1>Deploying a new spack environment<a class="headerlink" href="#deploying-a-new-spack-environment" title="Link to this heading"></a></h1>
<section id="where-do-we-update-compass-dependencies">
<h2>Where do we update compass dependencies?<a class="headerlink" href="#where-do-we-update-compass-dependencies" title="Link to this heading"></a></h2>
<section id="mache">
<h3>Mache<a class="headerlink" href="#mache" title="Link to this heading"></a></h3>
<p>If system modules change in E3SM, we try to stay in sync:</p>
<ul class="simple">
<li><p>compilers</p></li>
<li><p>MPI libraries</p></li>
<li><p>netcdf-C</p></li>
<li><p>netcdf-fortran</p></li>
<li><p>pnetcdf</p></li>
<li><p>mkl (or other linear algebra libs)</p></li>
</ul>
<p>When we update the mache version in compass, we also need to bump the compass
version (typically either the major or the minor version) and then re-deploy
shared spack environments on each supported machine.</p>
</section>
<section id="spack">
<h3>Spack<a class="headerlink" href="#spack" title="Link to this heading"></a></h3>
<p>Spack is for libraries used by MPAS and tools that need system MPI:</p>
<ul class="simple">
<li><p>ESMF</p></li>
<li><p>SCORPIO</p></li>
<li><p>Albany</p></li>
<li><p>PETSc</p></li>
<li><p>Netlib LAPACK</p></li>
</ul>
<p>When we update the versions of any of these libraries in compass, we also need
to bump the compass version (typically either the major or the minor version)
and then re-deploy shared spack environments on each supported machine.</p>
</section>
<section id="conda">
<h3>Conda<a class="headerlink" href="#conda" title="Link to this heading"></a></h3>
<p>Conda (via conda-forge) is used for python packages and related dependencies
that don’t need system MPI. Conda environments aren’t shared between
developers because the compass you’re developing is part of the conda
environment.</p>
<p>When we update the constraints on conda dependencies, we also need to bump the
compass alpha, beta or rc version.  We do not need to re-deploy spack
environments on share machines because they remain unaffected.</p>
</section>
</section>
<section id="id1">
<h2>Mache<a class="headerlink" href="#id1" title="Link to this heading"></a></h2>
<p>A brief tour of mache.</p>
<section id="identifying-e3sm-machines">
<h3>Identifying E3SM machines<a class="headerlink" href="#identifying-e3sm-machines" title="Link to this heading"></a></h3>
<p>Compass and other packages use mache to identify what machine they’re on (when
you’re on a login node).  This is used when configuring compass and creating a
conda environment.  Because of this, there is a “bootstrapping” process where
a conda environment is created with mache installed in it, then the machine is
identified and the rest of the compass setup can continue.</p>
</section>
<section id="config-options-describing-e3sm-machines">
<h3>Config options describing E3SM machines<a class="headerlink" href="#config-options-describing-e3sm-machines" title="Link to this heading"></a></h3>
<p>Mache has config files for each E3SM machine that tell us where E3SM-Unified
is, where to find diagnostics, and much more, see
<a class="reference external" href="https://github.com/E3SM-Project/mache/tree/main/mache/machines">machines</a>.
These config options are shared across packages including:</p>
<ul class="simple">
<li><p>MPAS-Analysis</p></li>
<li><p>E3SM_Diags</p></li>
<li><p>zppy</p></li>
<li><p>compass</p></li>
<li><p>E3SM-Unified</p></li>
</ul>
<p>Compass uses these config options to know how to make a job script, where to
find locally cached files in its “databases” and much more.</p>
</section>
<section id="modules-env-variables-etc-for-e3sm-machines">
<h3>Modules, env. variables, etc. for  E3SM machines<a class="headerlink" href="#modules-env-variables-etc-for-e3sm-machines" title="Link to this heading"></a></h3>
<p>Mache keeps its own copy of the E3SM file
<a class="reference external" href="https://github.com/E3SM-Project/E3SM/blob/master/cime_config/machines/config_machines.xml">config_machines.xml</a>
in the package <a class="reference external" href="https://github.com/E3SM-Project/mache/blob/main/mache/cime_machine_config/config_machines.xml">here</a>.
We try to keep a close eye on E3SM master and update mache when system modules
for machines that mache knows about get updated.  When this happens, we update
mache’s copy of <code class="docutils literal notranslate"><span class="pre">config_machines.xml</span></code> and that tells me which modules to
update in spack, see below.dev_quick_start</p>
</section>
<section id="mirroring-moab-on-chicoma">
<h3>Mirroring MOAB on Chicoma<a class="headerlink" href="#mirroring-moab-on-chicoma" title="Link to this heading"></a></h3>
<p>The firewall on LANL IC’s Chicoma blocks access to the MOAB package (at least
at the moment – Xylar has made a request to allow access).  To get around
this, someone testing or deploying spack builds on Chicoma will first need to
update the local spack mirror with the desired version of MOAB (5.5.1 in this
example).</p>
<p>First, you need to know the versions of the <code class="docutils literal notranslate"><span class="pre">mache</span></code> and <code class="docutils literal notranslate"><span class="pre">moab</span></code> packages
that are needed (1.20.0 and 5.5.1, respectively, in this example).  These are
specified in <code class="docutils literal notranslate"><span class="pre">conda/configure_compass_env.py</span></code> and <code class="docutils literal notranslate"><span class="pre">conda/default.cfg</span></code>,
respectively.  On a LANL laptop with either (1) the VPN turned off and the
proxies unset or (2) the VPN turned on and the proxies set, run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">MACHE_VER</span><span class="o">=</span><span class="m">1</span>.20.0
<span class="nv">MOAB_VER</span><span class="o">=</span><span class="m">5</span>.5.1
mkdir<span class="w"> </span>spack_mirror
<span class="nb">cd</span><span class="w"> </span>spack_mirror
git<span class="w"> </span>clone<span class="w"> </span>git@github.com:E3SM-Project/spack.git<span class="w"> </span>-b<span class="w"> </span>spack_for_mache_<span class="si">${</span><span class="nv">MACHE_VER</span><span class="si">}</span><span class="w"> </span>spack_for_mache_<span class="si">${</span><span class="nv">MACHE_VER</span><span class="si">}</span>
<span class="nb">source</span><span class="w"> </span>spack_for_mache_<span class="si">${</span><span class="nv">MACHE_VER</span><span class="si">}</span>/share/spack/setup-env.sh

<span class="c1"># remove any cache files that might cause trouble</span>
rm<span class="w"> </span>-rf<span class="w"> </span>~/.spack

<span class="c1"># this should create spack_mirror with subdirectories moab and _source-cache</span>
spack<span class="w"> </span>mirror<span class="w"> </span>create<span class="w"> </span>-d<span class="w"> </span>spack_mirror<span class="w"> </span>moab@<span class="si">${</span><span class="nv">MOAB_VER</span><span class="si">}</span>

tar<span class="w"> </span>cvfj<span class="w"> </span>spack_mirror.tar.bz2<span class="w"> </span>spack_mirror
</pre></div>
</div>
<p>Then, if you used option (1) above turn on the LANL VPN (and set the proxies).
You may find it convenient to login on to Chicoma
(e.g. <code class="docutils literal notranslate"><span class="pre">ssh</span> <span class="pre">-tt</span> <span class="pre">wtrw</span> <span class="pre">'ssh</span> <span class="pre">ch-fe'</span></code>) in a separate terminal if you have
configured your laptop to preserve connections.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rsync<span class="w"> </span>-rLpt<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;ssh wtrw ssh&#39;</span><span class="w"> </span>spack_mirror.tar.bz2<span class="w"> </span>ch-fe:/usr/projects/e3sm/compass/chicoma-cpu/spack/
</pre></div>
</div>
<p>Then, on Chicoma:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>/usr/projects/e3sm/compass/chicoma-cpu/spack/
tar<span class="w"> </span>xvf<span class="w"> </span>spack_mirror.tar.bz2
chgrp<span class="w"> </span>-R<span class="w"> </span>climate<span class="w"> </span>spack_mirror/
chmod<span class="w"> </span>-R<span class="w"> </span>ug+w<span class="w"> </span>spack_mirror/
chmod<span class="w"> </span>-R<span class="w"> </span>ugo+rX<span class="w"> </span>spack_mirror/
rm<span class="w"> </span>spack_mirror.tar.bz2
</pre></div>
</div>
</section>
<section id="creating-spack-environments">
<h3>Creating spack environments<a class="headerlink" href="#creating-spack-environments" title="Link to this heading"></a></h3>
<p>Mache has templates for making spack environments on some of the E3SM supported
machines.  See <a class="reference external" href="https://github.com/E3SM-Project/mache/tree/main/mache/spack">spack</a>.
It also has functions for building the spack environments with these templates
using E3SM’s fork of spack (see below).</p>
</section>
</section>
<section id="updating-spack-from-compass-with-mache-from-a-remote-branch">
<h2>Updating spack from compass with mache from a remote branch<a class="headerlink" href="#updating-spack-from-compass-with-mache-from-a-remote-branch" title="Link to this heading"></a></h2>
<p>If you haven’t cloned compass and added my fork, here’s the process:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>compass
<span class="nb">cd</span><span class="w"> </span>compass/
git<span class="w"> </span>clone<span class="w"> </span>git@github.com:MPAS-Dev/compass.git<span class="w"> </span>main
<span class="nb">cd</span><span class="w"> </span>main/
git<span class="w"> </span>remote<span class="w"> </span>add<span class="w"> </span>xylar/compass<span class="w"> </span>git@github.com:xylar/compass.git
</pre></div>
</div>
<p>Now, we need to set up compass and build spack packages making use of the
updated mache.  This involves changing the mache version in a couple of places
in compass and updating the version of compass itself to a new alpha, beta or
rc.  As an example, we will use the branch
<a class="reference external" href="https://github.com/xylar/compass/tree/simplify_local_mache">simplify_local_mache</a>.</p>
<p>Often, we will need to test with a <code class="docutils literal notranslate"><span class="pre">mache</span></code> branch that has changes needed
by compass.  Here, we will use <code class="docutils literal notranslate"><span class="pre">&lt;fork&gt;</span></code> as a stand-in for the fork of mache
to use (e.g. <code class="docutils literal notranslate"><span class="pre">E3SM-Project/mache</span></code>) and <code class="docutils literal notranslate"><span class="pre">&lt;branch&gt;</span></code> as the stand-in for a branch on
that fork (e.g. <code class="docutils literal notranslate"><span class="pre">main</span></code>).</p>
<p>We also need to make sure there is a spack branch for the version of compass.
The spack branch is a branch off of the develop branch on
<a class="reference external" href="https://github.com/E3SM-Project/spack">E3SM’s spack repo</a> that has any
updates to packages required for this version of mache.  The remote branch
is named after the release version of mache (omitting any alpha, beta or rc
suffix because it is intended to be the spack branch we will use once the
<code class="docutils literal notranslate"><span class="pre">mache</span></code> release happens).  In this example, we will work with the branch
<a class="reference external" href="https://github.com/E3SM-Project/spack/tree/spack_for_mache_1.12.0">spack_for_mache_1.12.0</a>.
The local clone is instead named after the compass version (again any omitting
alpha, beta or rc) plus the compiler and MPI library because we have discovered
two users cannot make modifications to the same git clone.  Giving each clone
of the spack branch a unique name ensures that they are independent.</p>
<p>Here’s how to get a branch of compass we’re testing (<code class="docutils literal notranslate"><span class="pre">simplify_local_mache</span></code>
in this case) as a local worktree:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># get my branch</span>
git<span class="w"> </span>fetch<span class="w"> </span>--all<span class="w"> </span>-p
<span class="c1"># make a worktree for checking out my branch</span>
git<span class="w"> </span>worktree<span class="w"> </span>add<span class="w"> </span>../simplify_local_mache<span class="w"> </span>-b<span class="w"> </span>simplify_local_mache<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--checkout<span class="w"> </span>xylar/compass/simplify_local_mache
<span class="nb">cd</span><span class="w"> </span>../simplify_local_mache/
</pre></div>
</div>
<p>You will also need a local installation of
<a class="reference external" href="https://github.com/conda-forge/miniforge?tab=readme-ov-file#miniforge3">Miniforge</a>.
Compass can do this for you if you haven’t already installed it.  If you want
to download it manually, use the Linux x86_64 version for all our supported
machines.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We have found that an existing Miniconda3 installation <strong>does not</strong> always
work well for compass, so please start with Miniforge3 instead.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You definitely need your own local Miniforge3 installation – you can’t use
a system version or a shared one like E3SM-Unified.</p>
</div>
<p>Define a location where Miniforge3 is installed or where you want to install
it:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># change to your conda installation</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">CONDA_BASE</span><span class="o">=</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span>/miniforge
</pre></div>
</div>
<p>Okay, we’re finally ready to do a test spack build for compass.
To do this, we call the <code class="docutils literal notranslate"><span class="pre">configure_compass_env.py</span></code> script using
<code class="docutils literal notranslate"><span class="pre">--mache_fork</span></code>, <code class="docutils literal notranslate"><span class="pre">--mache_branch</span></code>, <code class="docutils literal notranslate"><span class="pre">--update_spack</span></code>, <code class="docutils literal notranslate"><span class="pre">--spack</span></code> and
<code class="docutils literal notranslate"><span class="pre">--tmpdir</span></code>. Here is an example appropriate for Anvil or Chrysalis:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">TMPDIR</span><span class="o">=</span>/lcrc/group/e3sm/<span class="si">${</span><span class="nv">USER</span><span class="si">}</span>/spack_temp
./conda/configure_compass_env.py<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--conda<span class="w"> </span><span class="si">${</span><span class="nv">CONDA_BASE</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--mache_fork<span class="w"> </span>&lt;fork&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--mache_branch<span class="w"> </span>&lt;branch&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--update_spack<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--spack<span class="w"> </span>/lcrc/group/e3sm/<span class="si">${</span><span class="nv">USER</span><span class="si">}</span>/spack_test<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--tmpdir<span class="w"> </span><span class="si">${</span><span class="nv">TMPDIR</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--compiler<span class="w"> </span>intel<span class="w"> </span>intel<span class="w"> </span>gnu<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--mpi<span class="w"> </span>openmpi<span class="w"> </span>impi<span class="w"> </span>openmpi<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--recreate
</pre></div>
</div>
<p>The directory you point to with <code class="docutils literal notranslate"><span class="pre">--conda</span></code> either doesn’t exist or contains
your existing installation of Miniforge3.</p>
<p>When you supply <code class="docutils literal notranslate"><span class="pre">--mache_fork</span></code> and <code class="docutils literal notranslate"><span class="pre">--mache_branch</span></code>, compass will clone
a fork of the <code class="docutils literal notranslate"><span class="pre">mache</span></code> repo and check out the requested branch, then install
that version of mache into both the compass installation conda environment and
the final compass environment.</p>
<p><code class="docutils literal notranslate"><span class="pre">mache</span></code> gets installed twice because the deployment tools need <code class="docutils literal notranslate"><span class="pre">mache</span></code> to
even know how to install compass and build the spack environment on supported
machines.  The “prebootstrap” step in deployment is creating the installation
conda environment.  The “bootstrap” step is creating the conda environment that
compass will actually use and (in this case with <code class="docutils literal notranslate"><span class="pre">--update_spack</span></code>) building
spack packages, then creating the “load” or “activation” script that you will
need to build MPAS components and run compass.</p>
<p>For testing, you want to point to a different location for installing spack
using <code class="docutils literal notranslate"><span class="pre">--spack</span></code>.</p>
<p>On many machines, the <code class="docutils literal notranslate"><span class="pre">/tmp</span></code> directory is not a safe place to build spack
packages.  Use <code class="docutils literal notranslate"><span class="pre">--tmpdir</span></code> to point to another place, e.g., your scratch
space.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">--recreate</span></code> flag may not be strictly necessary but it’s a good idea.
This will make sure both the bootstrapping conda environment (the one that
installs mache to identify the machine) and the compass conda environment are
created fresh.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">--compiler</span></code> flag is a list of one or more compilers to build for and the
<code class="docutils literal notranslate"><span class="pre">--mpi</span></code> flag is the corresponding list of MPI libraries.  To see what is
supported on each machine, take a look at <a class="reference internal" href="machines/index.html#dev-supported-machines"><span class="std std-ref">Supported Machines</span></a>.</p>
<p>Be aware that not all compilers and MPI libraries support Albany and PETSc, as
discussed below.</p>
<section id="testing-spack-with-petsc-and-netlib-lapack">
<h3>Testing spack with PETSc (and Netlib LAPACK)<a class="headerlink" href="#testing-spack-with-petsc-and-netlib-lapack" title="Link to this heading"></a></h3>
<p>If you want to build PETSc (and Netlib LAPACK), use the <code class="docutils literal notranslate"><span class="pre">--with_petsc</span></code> flag.
Currently, this only works with some
compilers, but that may be more that I was trying to limit the amount of work
for the compass support team.  There is a file,
<a class="reference external" href="https://github.com/MPAS-Dev/compass/blob/main/conda/petsc_supported.txt">petsc_supported.txt</a>,
that lists supported compilers and MPI libraries on each machine.</p>
<p>Here is an example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">TMPDIR</span><span class="o">=</span>/lcrc/group/e3sm/<span class="si">${</span><span class="nv">USER</span><span class="si">}</span>/spack_temp
./conda/configure_compass_env.py<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--conda<span class="w"> </span><span class="si">${</span><span class="nv">CONDA_BASE</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--mache_fork<span class="w"> </span>&lt;fork&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--mache_branch<span class="w"> </span>&lt;branch&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--update_spack<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--spack<span class="w"> </span>/lcrc/group/e3sm/<span class="si">${</span><span class="nv">USER</span><span class="si">}</span>/spack_test<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--tmpdir<span class="w"> </span><span class="si">${</span><span class="nv">TMPDIR</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--compiler<span class="w"> </span>intel<span class="w"> </span>gnu<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--mpi<span class="w"> </span>openmpi<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--with_petsc<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--recreate<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--verbose
</pre></div>
</div>
</section>
<section id="testing-spack-with-albany">
<h3>Testing spack with Albany<a class="headerlink" href="#testing-spack-with-albany" title="Link to this heading"></a></h3>
<p>If you also want to build Albany, use the <code class="docutils literal notranslate"><span class="pre">--with_albany</span></code> flag.  Currently,
this only works with Gnu compilers.  There is a file,
<a class="reference external" href="https://github.com/MPAS-Dev/compass/blob/main/conda/albany_supported.txt">albany_support.txt</a>,
that lists supported compilers and MPI libraries on each machine.</p>
<p>Here is an example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">TMPDIR</span><span class="o">=</span>/lcrc/group/e3sm/<span class="si">${</span><span class="nv">USER</span><span class="si">}</span>/spack_temp
./conda/configure_compass_env.py<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--conda<span class="w"> </span><span class="si">${</span><span class="nv">CONDA_BASE</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--mache_fork<span class="w"> </span>&lt;fork&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--mache_branch<span class="w"> </span>&lt;branch&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--update_spack<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--spack<span class="w"> </span>/lcrc/group/e3sm/<span class="si">${</span><span class="nv">USER</span><span class="si">}</span>/spack_test<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--tmpdir<span class="w"> </span><span class="si">${</span><span class="nv">TMPDIR</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--compiler<span class="w"> </span>gnu<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--mpi<span class="w"> </span>openmpi<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--with_albany<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--recreate
</pre></div>
</div>
</section>
<section id="troubleshooting-spack">
<h3>Troubleshooting spack<a class="headerlink" href="#troubleshooting-spack" title="Link to this heading"></a></h3>
<p>If you encounter an error like:
.. code-block:: none</p>
<blockquote>
<div><p>==&gt;   spack env activate dev_compass_1_2_0-alpha_6_gnu_mpich
==&gt; Error: Package ‘armpl’ not found.
You may need to run ‘spack clean -m’.</p>
</div></blockquote>
<p>during the attempt to build spack, you will first need to find the path to
<code class="docutils literal notranslate"><span class="pre">setup-env.sh</span></code> (see <code class="docutils literal notranslate"><span class="pre">compass/build_*/build*.sh</span></code>) and source that script to
get the <code class="docutils literal notranslate"><span class="pre">spack</span></code> command, e.g.:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span><span class="w"> </span><span class="si">${</span><span class="nv">PSCRATCH</span><span class="si">}</span>/spack_test/dev_compass_1_2_0-alpha_6_gnu_mpich/share/spack/setup-env.sh
</pre></div>
</div>
<p>Then run the suggested command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>spack<span class="w"> </span>clean<span class="w"> </span>-m
</pre></div>
</div>
<p>After that, re-running <code class="docutils literal notranslate"><span class="pre">./conda/configure_compass_env.py</span></code> should work correctly.</p>
<p>This issue seems to be related to switching between spack v0.18 and v0.19 (used by different versions of compass).</p>
</section>
</section>
<section id="testing-compass">
<h2>Testing compass<a class="headerlink" href="#testing-compass" title="Link to this heading"></a></h2>
<section id="testing-mpas-ocean-without-petsc">
<h3>Testing MPAS-Ocean without PETSc<a class="headerlink" href="#testing-mpas-ocean-without-petsc" title="Link to this heading"></a></h3>
<p>Please use the E3SM-Project submodule in compass for testing, rather than
E3SM’s master branch.  The submodule is the version we know works with compass
and serves as kind of a baseline for other testing.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># source whichever load script is appropriate</span>
<span class="nb">source</span><span class="w"> </span>load_dev_compass_1.2.0-alpha.5_chrysalis_intel_openmpi.sh
git<span class="w"> </span>submodule<span class="w"> </span>update<span class="w"> </span>--init<span class="w"> </span>--recursive
<span class="nb">cd</span><span class="w"> </span>E3SM-Project/components/mpas-ocean
<span class="c1"># this will build with PIO and OpenMP</span>
make<span class="w"> </span>ifort
compass<span class="w"> </span>suite<span class="w"> </span>-s<span class="w"> </span>-c<span class="w"> </span>ocean<span class="w"> </span>-t<span class="w"> </span>pr<span class="w"> </span>-p<span class="w"> </span>.<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-w<span class="w"> </span>/lcrc/group/e3sm/ac.xylar/compass/test_20230202/ocean_pr_chrys_intel_openmpi
<span class="nb">cd</span><span class="w"> </span>/lcrc/group/e3sm/ac.xylar/compass/test_20230202/ocean_pr_chrys_intel_openmpi
sbatch<span class="w"> </span>job_script.pr.bash
</pre></div>
</div>
<p>You can make other worktrees of E3SM-Project for testing other compilers if
that’s helpful.  It also might be good to open a fresh terminal to source a
new load script.  This isn’t required but you’ll get some warnings.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span><span class="w"> </span>load_dev_compass_1.2.0-alpha.5_chrysalis_gnu_openmpi.sh
<span class="nb">cd</span><span class="w"> </span>E3SM-Project
git<span class="w"> </span>worktree<span class="w"> </span>add<span class="w"> </span>../e3sm_chrys_gnu_openmpi
<span class="nb">cd</span><span class="w"> </span>../e3sm_chrys_gnu_openmpi
git<span class="w"> </span>submodule<span class="w"> </span>update<span class="w"> </span>--init<span class="w"> </span>--recursive
<span class="nb">cd</span><span class="w"> </span>components/mpas-ocean
make<span class="w"> </span>gfortran
compass<span class="w"> </span>suite<span class="w"> </span>-s<span class="w"> </span>-c<span class="w"> </span>ocean<span class="w"> </span>-t<span class="w"> </span>pr<span class="w"> </span>-p<span class="w"> </span>.<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-w<span class="w"> </span>/lcrc/group/e3sm/ac.xylar/compass/test_20230202/ocean_pr_chrys_gnu_openmpi
<span class="nb">cd</span><span class="w"> </span>/lcrc/group/e3sm/ac.xylar/compass/test_20230202/ocean_pr_chrys_gnu_openmpi
sbatch<span class="w"> </span>job_script.pr.bash
</pre></div>
</div>
<p>You can also explore the utility in
<a class="reference external" href="https://github.com/MPAS-Dev/compass/tree/main/utils/matrix">utils/matrix</a> to
test on several compilers automatically.</p>
</section>
<section id="testing-mali-with-albany">
<h3>Testing MALI with Albany<a class="headerlink" href="#testing-mali-with-albany" title="Link to this heading"></a></h3>
<p>Please use the MALI-Dev submodule in compass for testing, rather than MALI-Dev
develop branch.  The submodule is the version we know works with compass and
serves as kind of a baseline for other testing.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># source whichever load script is appropriate</span>
<span class="nb">source</span><span class="w"> </span>load_dev_compass_1.2.0-alpha.5_chrysalis_gnu_openmpi_albany.sh
git<span class="w"> </span>submodule<span class="w"> </span>update<span class="w"> </span>--init<span class="w"> </span>--recursive
<span class="nb">cd</span><span class="w"> </span>MALI-Dev/components/mpas-albany-landice
<span class="c1"># you need to tell it to build with Albany</span>
make<span class="w"> </span><span class="nv">ALBANY</span><span class="o">=</span><span class="nb">true</span><span class="w"> </span>gfortran
compass<span class="w"> </span>suite<span class="w"> </span>-s<span class="w"> </span>-c<span class="w"> </span>landice<span class="w"> </span>-t<span class="w"> </span>full_integration<span class="w"> </span>-p<span class="w"> </span>.<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-w<span class="w"> </span>/lcrc/group/e3sm/ac.xylar/compass/test_20230202/landice_full_chrys_gnu_openmpi
<span class="nb">cd</span><span class="w"> </span>/lcrc/group/e3sm/ac.xylar/compass/test_20230202/landice_full_chrys_gnu_openmpi
sbatch<span class="w"> </span>job_script.full_integration.bash
</pre></div>
</div>
</section>
<section id="testing-mpas-ocean-with-petsc">
<h3>Testing MPAS-Ocean with PETSc<a class="headerlink" href="#testing-mpas-ocean-with-petsc" title="Link to this heading"></a></h3>
<p>The tests for PETSc use nonhydrostatic capabilities not yet integrated into
E3SM.  So you can’t use the E3SM-Project submodule.  You need to use Sara
Calandrini’s <a class="reference external" href="https://github.com/scalandr/E3SM/tree/ocean/nonhydro">nonhydro</a>
branch.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># source whichever load script is appropriate</span>
<span class="nb">source</span><span class="w"> </span>load_dev_compass_1.2.0-alpha.5_chrysalis_intel_openmpi_petsc.sh
git<span class="w"> </span>submodule<span class="w"> </span>update<span class="w"> </span>--init
<span class="nb">cd</span><span class="w"> </span>E3SM-Project
git<span class="w"> </span>remote<span class="w"> </span>add<span class="w"> </span>scalandr/E3SM<span class="w"> </span>git@github.com:scalandr/E3SM.git
git<span class="w"> </span>worktree<span class="w"> </span>add<span class="w"> </span>../nonhydro_chrys_intel_openmpi<span class="w"> </span>-b<span class="w"> </span>nonhydro_chrys_intel_openmpi<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--checkout<span class="w"> </span>scalandr/E3SM/ocean/nonhydro
<span class="nb">cd</span><span class="w"> </span>../nonhydro_chrys_intel_openmpi
git<span class="w"> </span>submodule<span class="w"> </span>update<span class="w"> </span>--init<span class="w"> </span>--recursive
<span class="nb">cd</span><span class="w"> </span>components/mpas-ocean
<span class="c1"># this will build with PIO, Netlib LAPACK and PETSc</span>
make<span class="w"> </span>ifort
compass<span class="w"> </span>list<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>nonhydro
<span class="c1"># update these numbers for the 2 nonhydro test cases</span>
compass<span class="w"> </span>setup<span class="w"> </span>-n<span class="w"> </span><span class="m">245</span><span class="w"> </span><span class="m">246</span><span class="w"> </span>-p<span class="w"> </span>.<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-w<span class="w"> </span>/lcrc/group/e3sm/ac.xylar/compass/test_20230202/nonhydro_chrys_intel_openmpi
<span class="nb">cd</span><span class="w"> </span>/lcrc/group/e3sm/ac.xylar/compass/test_20230202/nonhydro_chrys_intel_openmpi
sbatch<span class="w"> </span>job_script.custom.bash
</pre></div>
</div>
<p>As with non-PETSc MPAS-Ocean and MALI, you can have different worktrees with
Sara’s nonhydro branch for building with different compilers or use
<a class="reference external" href="https://github.com/MPAS-Dev/compass/tree/main/utils/matrix">utils/matrix</a> to
build (and run).</p>
</section>
</section>
<section id="deploying-shared-spack-environments">
<h2>Deploying shared spack environments<a class="headerlink" href="#deploying-shared-spack-environments" title="Link to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Be careful about deploying shared spack environments, as changes you make
can affect other compass users.</p>
</div>
<p>Once compass has been tested with the spack builds in a temporary location, it
is time to deploy the shared spack environments for all developers to use.
A <code class="docutils literal notranslate"><span class="pre">mache</span></code> developer will make a <code class="docutils literal notranslate"><span class="pre">mache</span></code> release (if needed) before this
step begins.  So there is no need to build mache from a remote branch anymore.</p>
<p>Compass knows where to deploy spack on each machine because of the <code class="docutils literal notranslate"><span class="pre">spack</span></code>
config option specified in the <code class="docutils literal notranslate"><span class="pre">[deploy]</span></code> section of each machine’s config
file, see the <a class="reference external" href="https://github.com/MPAS-Dev/compass/tree/main/compass/machines">machine configs</a>.</p>
<p>It is best to update the remote compass branch in case of changes:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>simplify_local_mache
<span class="c1"># get any changes</span>
git<span class="w"> </span>fetch<span class="w"> </span>--all<span class="w"> </span>-p
<span class="c1"># hard reset if there are changes</span>
git<span class="w"> </span>reset<span class="w"> </span>–hard<span class="w"> </span>xylar/compass/simplify_local_mache
</pre></div>
</div>
<section id="deploy-spack-for-compass-without-albany-or-petsc">
<h3>Deploy spack for compass without Albany or PETSc<a class="headerlink" href="#deploy-spack-for-compass-without-albany-or-petsc" title="Link to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">TMPDIR</span><span class="o">=</span>/lcrc/group/e3sm/<span class="si">${</span><span class="nv">USER</span><span class="si">}</span>/spack_temp
./conda/configure_compass_env.py<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--conda<span class="w"> </span><span class="si">${</span><span class="nv">CONDA_BASE</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--update_spack<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--tmpdir<span class="w"> </span><span class="si">${</span><span class="nv">TMPDIR</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--compiler<span class="w"> </span>intel<span class="w"> </span>intel<span class="w"> </span>gnu<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--mpi<span class="w"> </span>openmpi<span class="w"> </span>impi<span class="w"> </span>openmpi<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--recreate
</pre></div>
</div>
</section>
<section id="deploying-spack-with-albany">
<h3>Deploying spack with Albany<a class="headerlink" href="#deploying-spack-with-albany" title="Link to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">TMPDIR</span><span class="o">=</span>/lcrc/group/e3sm/<span class="si">${</span><span class="nv">USER</span><span class="si">}</span>/spack_temp
./conda/configure_compass_env.py<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--conda<span class="w"> </span><span class="si">${</span><span class="nv">CONDA_BASE</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--update_spack<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--tmpdir<span class="w"> </span><span class="si">${</span><span class="nv">TMPDIR</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--compiler<span class="w"> </span>gnu<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--mpi<span class="w"> </span>openmpi<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--with_albany<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--recreate
</pre></div>
</div>
</section>
<section id="deploying-spack-with-petsc-and-netlib-lapack">
<h3>Deploying spack with PETSc (and Netlib LAPACK)<a class="headerlink" href="#deploying-spack-with-petsc-and-netlib-lapack" title="Link to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">TMPDIR</span><span class="o">=</span>/lcrc/group/e3sm/<span class="si">${</span><span class="nv">USER</span><span class="si">}</span>/spack_temp
./conda/configure_compass_env.py<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--conda<span class="w"> </span><span class="si">${</span><span class="nv">CONDA_BASE</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--update_spack<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--tmpdir<span class="w"> </span><span class="si">${</span><span class="nv">TMPDIR</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--compiler<span class="w"> </span>intel<span class="w"> </span>gnu<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--mpi<span class="w"> </span>openmpi<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--with_petsc<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--recreate<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--verbose
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="building_docs.html" class="btn btn-neutral float-left" title="Building the Documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="api.html" class="btn btn-neutral float-right" title="API reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Copyright (c) 2013-2021,  Los Alamos National Security, LLC (LANS) (Ocean: LA-CC-13-047;Land Ice: LA-CC-13-117) and the University Corporation for Atmospheric Research (UCAR)..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>