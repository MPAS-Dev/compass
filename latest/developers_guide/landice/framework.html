

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Land-ice Framework &mdash; compass latest documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=c6e86fd7"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Ocean core" href="../ocean/index.html" />
    <link rel="prev" title="thwaites" href="test_groups/thwaites.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            compass
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User's guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/quick_start.html">Quick Start for Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/test_cases.html">Test Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/config_files.html">Config Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/test_suites.html">Test Suites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/landice/index.html">Landice core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/ocean/index.html">Ocean core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/machines/index.html">Machines</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer's guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quick_start.html">Quick Start for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../command_line.html">Command-line interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../organization.html">Organization of Tests</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Landice core</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="test_groups/index.html">Test groups</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Land-ice Framework</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ais-observations">ais_observations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#extrapolate">extrapolate</a></li>
<li class="toctree-l3"><a class="reference internal" href="#iceshelf-melt">iceshelf_melt</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mesh">mesh</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ocean/index.html">Ocean core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../framework.html">Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../machines/index.html">Machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../building_docs.html">Building the Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploying_spack.html">Deploying a new spack environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../design_docs/index.html">Design Documents</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/dev_add_test_group.html">Developer Tutorial: Adding a new test group</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/dev_add_rrm.html">Developer Tutorial: Adding a new ocean/sea ice regionally refined mesh (RRM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/dev_add_param_study.html">Developer Tutorial: Adding a parameter study</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/dev_porting_legacy.html">Developer Tutorial: Porting a legacy COMPASS test group</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Glossary</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Versions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../versions.html">Code and Documentation Versions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">compass</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Landice core</a></li>
      <li class="breadcrumb-item active">Land-ice Framework</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/developers_guide/landice/framework.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="land-ice-framework">
<span id="dev-landice-framework"></span><h1>Land-ice Framework<a class="headerlink" href="#land-ice-framework" title="Link to this heading"></a></h1>
<section id="ais-observations">
<h2>ais_observations<a class="headerlink" href="#ais-observations" title="Link to this heading"></a></h2>
<p>The landice framework module <code class="docutils literal notranslate"><span class="pre">compass/landice/ais_observations.py</span></code> contains
observational data for various Antarctic basins.  These are based on the
ISMIP6 basin definitions, but it need not be limited to those.  The basins do
not need to be mutually exclusive, so more can be added as needed.</p>
</section>
<section id="extrapolate">
<h2>extrapolate<a class="headerlink" href="#extrapolate" title="Link to this heading"></a></h2>
<p>The landice framework module <code class="docutils literal notranslate"><span class="pre">compass/landice/extrapolate.py</span></code> provides a
function for extrapolating variables into undefined regions.  It is copied
from a similar script in MPAS-Tools.</p>
</section>
<section id="iceshelf-melt">
<h2>iceshelf_melt<a class="headerlink" href="#iceshelf-melt" title="Link to this heading"></a></h2>
<p>The landice framework module <code class="docutils literal notranslate"><span class="pre">compass/landice/iceshelf_melt.py</span></code> provides
functionality related to ice-shelf basal melting.  Currently, there is a
single function <code class="docutils literal notranslate"><span class="pre">calc_mean_TF</span></code> that calculated the mean thermal forcing
along the ice-shelf draft in a domain for a given geometry file and thermal
forcing file.</p>
</section>
<section id="mesh">
<h2>mesh<a class="headerlink" href="#mesh" title="Link to this heading"></a></h2>
<p>The landice framework module <code class="xref py py-mod docutils literal notranslate"><span class="pre">compass.landice.mesh</span></code> provides functions
used by all <code class="docutils literal notranslate"><span class="pre">mesh_gen</span></code> tests cases, which currently exist within the
<code class="docutils literal notranslate"><span class="pre">antarctica</span></code>, <code class="docutils literal notranslate"><span class="pre">crane</span></code>, <code class="docutils literal notranslate"><span class="pre">greenland</span></code>, <code class="docutils literal notranslate"><span class="pre">humboldt</span></code>, <code class="docutils literal notranslate"><span class="pre">kangerlussuaq</span></code>,
<code class="docutils literal notranslate"><span class="pre">koge_bugt_s</span></code>, and <code class="docutils literal notranslate"><span class="pre">thwaites</span></code> test groups. These functions include:</p>
<p><a class="reference internal" href="generated/compass.landice.mesh.add_bedmachine_thk_to_ais_gridded_data.html#compass.landice.mesh.add_bedmachine_thk_to_ais_gridded_data" title="compass.landice.mesh.add_bedmachine_thk_to_ais_gridded_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.landice.mesh.add_bedmachine_thk_to_ais_gridded_data()</span></code></a>
copies BedMachine thickness to the AIS reference gridded dataset.
It replaces thickness field in the compilation dataset with the one we
will be using from BedMachine for actual thickness interpolation
There are significant inconsistencies between the masking of the two,
particularly along the Antarctic Peninsula, that lead to funky
mesh extent and culling if we use the thickness from 8km composite
dataset to define the cullMask but then actually interpolate thickness
from BedMachine.
This function uses bilinear interpolation to interpolate from the 500 m
resolution of BedMachine to the 8 km resolution of the reference dataset.
It is not particularly accurate, but is fast and adequate for generating
the flood filled mask for culling the mesh.  Highly accurate conservative
remapping is performed later for actually interpolating BedMachine
thickness to the final MALI mesh.</p>
<p><a class="reference internal" href="generated/compass.landice.mesh.clean_up_after_interp.html#compass.landice.mesh.clean_up_after_interp" title="compass.landice.mesh.clean_up_after_interp"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.landice.mesh.clean_up_after_interp()</span></code></a> performs some final
clean up steps after interpolation for the AIS mesh case.</p>
<p><a class="reference internal" href="generated/compass.landice.mesh.gridded_flood_fill.html#compass.landice.mesh.gridded_flood_fill" title="compass.landice.mesh.gridded_flood_fill"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.landice.mesh.gridded_flood_fill()</span></code></a> applies a flood-fill algorithm
to the gridded dataset in order to separate the ice sheet from peripheral ice.</p>
<p><a class="reference internal" href="generated/compass.landice.mesh.interp_gridded2mali.html#compass.landice.mesh.interp_gridded2mali" title="compass.landice.mesh.interp_gridded2mali"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.landice.mesh.interp_gridded2mali()</span></code></a> interpolates gridded data
(e.g. BedMachine thickness or MEaSUREs ice velocity) to a MALI mesh, accounting
for masking of the ice extent to avoid interpolation ramps. This functions works
for both Antarctica and Greenland.</p>
<p><a class="reference internal" href="generated/compass.landice.mesh.preprocess_ais_data.html#compass.landice.mesh.preprocess_ais_data" title="compass.landice.mesh.preprocess_ais_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.landice.mesh.preprocess_ais_data()</span></code></a> performs adjustments to
gridded AIS datasets needed for rest of compass workflow to utilize them.</p>
<p><a class="reference internal" href="generated/compass.landice.mesh.set_rectangular_geom_points_and_edges.html#compass.landice.mesh.set_rectangular_geom_points_and_edges" title="compass.landice.mesh.set_rectangular_geom_points_and_edges"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.landice.mesh.set_rectangular_geom_points_and_edges()</span></code></a> sets node
and edge coordinates to pass to py:func:<cite>mpas_tools.mesh.creation.build_mesh.build_planar_mesh()</cite>.</p>
<p><a class="reference internal" href="generated/compass.landice.mesh.set_cell_width.html#compass.landice.mesh.set_cell_width" title="compass.landice.mesh.set_cell_width"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.landice.mesh.set_cell_width()</span></code></a> sets cell widths based on settings
in config file to pass to <a class="reference external" href="http://mpas-dev.github.io/MPAS-Tools/master/generated/mpas_tools.mesh.creation.build_mesh.build_planar_mesh.html#mpas_tools.mesh.creation.build_mesh.build_planar_mesh" title="(in mpas_tools v0.36.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">mpas_tools.mesh.creation.build_mesh.build_planar_mesh()</span></code></a>.
Requires the following options to be set in the given config section: <code class="docutils literal notranslate"><span class="pre">min_spac</span></code>,
<code class="docutils literal notranslate"><span class="pre">max_spac</span></code>, <code class="docutils literal notranslate"><span class="pre">high_log_speed</span></code>, <code class="docutils literal notranslate"><span class="pre">low_log_speed</span></code>, <code class="docutils literal notranslate"><span class="pre">high_dist</span></code>, <code class="docutils literal notranslate"><span class="pre">low_dist</span></code>,
<code class="docutils literal notranslate"><span class="pre">high_dist_bed</span></code>, <code class="docutils literal notranslate"><span class="pre">low_dist_bed</span></code>, <code class="docutils literal notranslate"><span class="pre">high_bed</span></code>, <code class="docutils literal notranslate"><span class="pre">low_bed</span></code>, <code class="docutils literal notranslate"><span class="pre">cull_distance</span></code>,
<code class="docutils literal notranslate"><span class="pre">use_speed</span></code>, <code class="docutils literal notranslate"><span class="pre">use_dist_to_edge</span></code>, <code class="docutils literal notranslate"><span class="pre">use_dist_to_grounding_line</span></code>, and <code class="docutils literal notranslate"><span class="pre">use_bed</span></code>.</p>
<p><a class="reference internal" href="generated/compass.landice.mesh.get_dist_to_edge_and_gl.html#compass.landice.mesh.get_dist_to_edge_and_gl" title="compass.landice.mesh.get_dist_to_edge_and_gl"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.landice.mesh.get_dist_to_edge_and_gl()</span></code></a> calculates distance from
each point to ice edge and grounding line, to be used in mesh density functions in
<a class="reference internal" href="generated/compass.landice.mesh.set_cell_width.html#compass.landice.mesh.set_cell_width" title="compass.landice.mesh.set_cell_width"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.landice.mesh.set_cell_width()</span></code></a>. In future development,
this should be updated to use a faster package such as <cite>scikit-fmm</cite>.</p>
<p><a class="reference internal" href="generated/compass.landice.mesh.build_cell_width.html#compass.landice.mesh.build_cell_width" title="compass.landice.mesh.build_cell_width"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.landice.mesh.build_cell_width()</span></code></a> determine final MPAS mesh cell sizes
using desired cell widths calculated by py:func:<cite>compass.landice.mesh.set_cell_width()</cite>,
based on user-defined density functions and config options.</p>
<p><a class="reference internal" href="generated/compass.landice.mesh.build_mali_mesh.html#compass.landice.mesh.build_mali_mesh" title="compass.landice.mesh.build_mali_mesh"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.landice.mesh.build_mali_mesh()</span></code></a> creates the MALI mesh based on final
cell widths determined by py:func:<cite>compass.landice.mesh.build_cell_width()</cite>, using Jigsaw
and MPAS-Tools functions. Culls the mesh based on config options, interpolates
all available fields from the gridded dataset to the MALI mesh using the bilinear
method, and marks domain boundaries as Dirichlet cells.</p>
<p><a class="reference internal" href="generated/compass.landice.mesh.make_region_masks.html#compass.landice.mesh.make_region_masks" title="compass.landice.mesh.make_region_masks"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.landice.mesh.make_region_masks()</span></code></a> creates region masks using regions
defined in Geometric Features repository. It is only used by the <code class="docutils literal notranslate"><span class="pre">antarctica</span></code>
and <code class="docutils literal notranslate"><span class="pre">greenland</span></code> test cases.</p>
<p>The following config options should be defined for all <code class="docutils literal notranslate"><span class="pre">mesh_gen</span></code> test cases (although
not necessarily with the same values shown here, which are the defaults for the 1–10km
Humboldt mesh):</p>
<div class="highlight-cfg notranslate"><div class="highlight"><pre><span></span><span class="c1"># config options for humboldt test cases</span>
<span class="k">[mesh]</span>

<span class="c1"># number of levels in the mesh</span>
<span class="na">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">10</span>

<span class="c1"># Bounds of Humboldt domain. If you want the extent</span>
<span class="c1"># of the gridded dataset to determine the extent of</span>
<span class="c1"># the MALI domain, set these to None.</span>
<span class="na">x_min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">-630000.</span>
<span class="na">x_max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">84000.</span>
<span class="na">y_min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">-1560000.</span>
<span class="na">y_max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">-860000.</span>

<span class="c1"># distance from ice margin to cull (km).</span>
<span class="c1"># Set to a value &lt;= 0 if you do not want</span>
<span class="c1"># to cull based on distance from margin.</span>
<span class="na">cull_distance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">5.0</span>

<span class="c1"># mesh density parameters</span>
<span class="c1"># minimum cell spacing (meters)</span>
<span class="na">min_spac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1.e3</span>
<span class="c1"># maximum cell spacing (meters)</span>
<span class="na">max_spac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1.e4</span>
<span class="c1"># log10 of max speed (m/yr) for cell spacing</span>
<span class="na">high_log_speed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">2.5</span>
<span class="c1"># log10 of min speed (m/yr) for cell spacing</span>
<span class="na">low_log_speed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0.75</span>
<span class="c1"># distance at which cell spacing = max_spac (meters)</span>
<span class="na">high_dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1.e5</span>
<span class="c1"># distance within which cell spacing = min_spac (meters)</span>
<span class="na">low_dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1.e4</span>

<span class="c1"># These *_bed settings are only applied when use_bed = True.</span>
<span class="c1"># distance at which bed topography has no effect</span>
<span class="na">high_dist_bed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1.e5</span>
<span class="c1"># distance within which bed topography has maximum effect</span>
<span class="na">low_dist_bed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">5.e4</span>
<span class="c1"># Bed elev beneath which cell spacing is minimized</span>
<span class="na">low_bed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">50.0</span>
<span class="c1"># Bed elev above which cell spacing is maximized</span>
<span class="na">high_bed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">100.0</span>

<span class="c1"># mesh density functions</span>
<span class="na">use_speed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">True</span>
<span class="na">use_dist_to_grounding_line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">False</span>
<span class="na">use_dist_to_edge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">True</span>
<span class="na">use_bed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">True</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="test_groups/thwaites.html" class="btn btn-neutral float-left" title="thwaites" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../ocean/index.html" class="btn btn-neutral float-right" title="Ocean core" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Copyright (c) 2013-2021,  Los Alamos National Security, LLC (LANS) (Ocean: LA-CC-13-047;Land Ice: LA-CC-13-117) and the University Corporation for Atmospheric Research (UCAR)..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>