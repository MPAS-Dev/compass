

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Ocean framework &mdash; compass latest documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Framework" href="../framework.html" />
    <link rel="prev" title="ziso" href="test_groups/ziso.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> compass
          

          
          </a>

          
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User's guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/quick_start.html">Quick Start for Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/test_cases.html">Test Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/config_files.html">Config Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/test_suites.html">Test Suites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/landice/index.html">Landice core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/ocean/index.html">Ocean core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/machines/index.html">Machines</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer's guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quick_start.html">Quick Start for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../command_line.html">Command-line interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../organization.html">Organization of Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../landice/index.html">Landice core</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Ocean core</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="test_groups/index.html">Test groups</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Ocean framework</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#namelist-replacements-and-streams-files">Namelist replacements and streams files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#vertical-coordinate">Vertical coordinate</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ice-shelf-cavities">Ice-shelf cavities</a></li>
<li class="toctree-l3"><a class="reference internal" href="#particles">Particles</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plotting">Plotting</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../framework.html">Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../machines/index.html">Machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../building_docs.html">Building the Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../design_docs/index.html">Design Documents</a></li>
</ul>
<p class="caption"><span class="caption-text">Glossary</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>
<p class="caption"><span class="caption-text">Versions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../versions.html">Code and Documentation Versions</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">compass</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Ocean core</a> &raquo;</li>
        
      <li>Ocean framework</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/developers_guide/ocean/framework.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="ocean-framework">
<span id="dev-ocean-framework"></span><h1>Ocean framework<a class="headerlink" href="#ocean-framework" title="Permalink to this headline">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">ocean</span></code> core contains a small amount of shared framework code that we
expect to expand in the future as new test cases are added.</p>
<div class="section" id="namelist-replacements-and-streams-files">
<h2>Namelist replacements and streams files<a class="headerlink" href="#namelist-replacements-and-streams-files" title="Permalink to this headline">¶</a></h2>
<p>The modules <code class="docutils literal notranslate"><span class="pre">compass.ocean.namelists</span></code> and <code class="docutils literal notranslate"><span class="pre">compass.ocean.streams</span></code> contain
namelist replacements and streams files that are similar to core-level
templates in <a class="reference internal" href="../../index.html#legacy-compass"><span class="std std-ref">Legacy COMPASS</span></a>.  Current templates are for adjusting sea
surface height in ice-shelf cavities, and outputting variables related to
frazil ice and land-ice fluxes.</p>
</div>
<div class="section" id="vertical-coordinate">
<span id="dev-ocean-framework-vertical"></span><h2>Vertical coordinate<a class="headerlink" href="#vertical-coordinate" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">compass.ocean.vertical</span></code> module provides support for computing general
vertical coordinates for MPAS-Ocean test cases.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">compass.ocean.vertical.grid_1d</span></code> module provides 1D vertical
coordinates.  To create 1D vertical grids, test cases should call
<a class="reference internal" href="generated/compass.ocean.vertical.grid_1d.generate_1d_grid.html#compass.ocean.vertical.grid_1d.generate_1d_grid" title="compass.ocean.vertical.grid_1d.generate_1d_grid"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.ocean.vertical.grid_1d.generate_1d_grid()</span></code></a> with the desired
config options set in the <code class="docutils literal notranslate"><span class="pre">vertical_grid</span></code> section (as described in
<a class="reference internal" href="../../users_guide/ocean/framework/vertical.html#ocean-vertical"><span class="std std-ref">Vertical coordinate</span></a>).</p>
<p>The z-level and z-star coordinates are also controlled by config options from
this section of the config file. The function
<a class="reference internal" href="generated/compass.ocean.vertical.init_vertical_coord.html#compass.ocean.vertical.init_vertical_coord" title="compass.ocean.vertical.init_vertical_coord"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.ocean.vertical.init_vertical_coord()</span></code></a> can be used to compute
<code class="docutils literal notranslate"><span class="pre">minLevelCell</span></code>, <code class="docutils literal notranslate"><span class="pre">maxLevelCell</span></code>, <code class="docutils literal notranslate"><span class="pre">cellMask</span></code>, <code class="docutils literal notranslate"><span class="pre">layerThickness</span></code>, <code class="docutils literal notranslate"><span class="pre">zMid</span></code>,
and <code class="docutils literal notranslate"><span class="pre">restingThickness</span></code> variables for <a class="reference internal" href="../../users_guide/ocean/framework/vertical.html#ocean-z-level"><span class="std std-ref">z-level</span></a> and
<a class="reference internal" href="../../users_guide/ocean/framework/vertical.html#ocean-z-star"><span class="std std-ref">z-star</span></a> coordinates using the <code class="docutils literal notranslate"><span class="pre">ssh</span></code> and <code class="docutils literal notranslate"><span class="pre">bottomDepth</span></code> as well
as config options from <code class="docutils literal notranslate"><span class="pre">vertical_grid</span></code>.</p>
</div>
<div class="section" id="ice-shelf-cavities">
<span id="dev-ocean-framework-iceshelf"></span><h2>Ice-shelf cavities<a class="headerlink" href="#ice-shelf-cavities" title="Permalink to this headline">¶</a></h2>
<p>The module <code class="docutils literal notranslate"><span class="pre">compass.ocean.iceshelf</span></code> defines two functions that are used to
set up domains with ice-shelf cavities.</p>
<p><a class="reference internal" href="generated/compass.ocean.iceshelf.compute_land_ice_pressure_and_draft.html#compass.ocean.iceshelf.compute_land_ice_pressure_and_draft" title="compass.ocean.iceshelf.compute_land_ice_pressure_and_draft"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.ocean.iceshelf.compute_land_ice_pressure_and_draft()</span></code></a>
computes the <code class="docutils literal notranslate"><span class="pre">landIcePressure</span></code> and <code class="docutils literal notranslate"><span class="pre">landIceDraft</span></code> fields based on the
sea-surface height (SSH) and a reference density (typically the the Boussinesq
reference density).</p>
<p><a class="reference internal" href="generated/compass.ocean.iceshelf.adjust_ssh.html#compass.ocean.iceshelf.adjust_ssh" title="compass.ocean.iceshelf.adjust_ssh"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.ocean.iceshelf.adjust_ssh()</span></code></a> performs a series of forward
runs with MPAS-Ocean to detect and correct imbalances between the SSH and the
land-ice pressure.  In each forward run, the SSH is allowed to evolve forward
in time for a short period (typically 1 hour), then the resulting change in
SSH is translated into a compensating change in land-ice pressure that is
expected to reduce the change in SSH.  The initial land-ice pressure is updated
accordingly and the process is repeated for a fixed number of iterations,
typically leading to smaller and smaller changes in the land-ice pressure.
This process does not completely eliminate the dynamical adjustment of the
ocean to the overlying weight of the ice shelf but it tends to reduce it
substantially and to prevent it from causing numerical instabilities.  This
procedure is also largely agnostic to the equation of state being used or the
method for implementing the horizontal pressure-gradient force.</p>
</div>
<div class="section" id="particles">
<span id="dev-ocean-framework-particles"></span><h2>Particles<a class="headerlink" href="#particles" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">compass.ocean.particles</span></code> module contains functionality for initializing
particles for the <a class="reference external" href="https://doi.org/10.1175/JPO-D-14-0260.1">LIGHT framework</a>.</p>
<p><a class="reference internal" href="generated/compass.ocean.particles.write.html#compass.ocean.particles.write" title="compass.ocean.particles.write"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.ocean.particles.write()</span></code></a> creates an initial condition for
particles partitioned across cores.  There are 3 possible particle types (or
<code class="docutils literal notranslate"><span class="pre">all</span></code> to indicate that all 3 types will be generated):</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">buoyancy</span></code></dt><dd><p>Particles are constrained to buoyancy (isopycnal) surfaces</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">passive</span></code></dt><dd><p>Particles move both horizontally and vertically as passive tracers</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">surface</span></code></dt><dd><p>Particles are constrained to the top ocean level</p>
</dd>
</dl>
<p><a class="reference internal" href="generated/compass.ocean.particles.remap_particles.html#compass.ocean.particles.remap_particles" title="compass.ocean.particles.remap_particles"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.ocean.particles.remap_particles()</span></code></a> is used to remap particles
onto a new grid decomposition.  This might be useful, for example, if you wish
to change the number of cores that a particle initial condition should run on.</p>
</div>
<div class="section" id="plotting">
<span id="dev-ocean-framework-plot"></span><h2>Plotting<a class="headerlink" href="#plotting" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">compass.ocean.plot</span></code> contains functionality for plotting the initial
state and 1D vertical grid.</p>
<p><a class="reference internal" href="generated/compass.ocean.plot.plot_initial_state.html#compass.ocean.plot.plot_initial_state" title="compass.ocean.plot.plot_initial_state"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.ocean.plot.plot_initial_state()</span></code></a> creates histogram plots of
salinity, temperature, bottom depth, <code class="docutils literal notranslate"><span class="pre">maxLevelCell</span></code>, layer thickness and the
Haney number from global initial condition.  This is useful for providing a
quick sanity check that these values have the expected range and distribution,
based on previous meshes.</p>
<p><a class="reference internal" href="generated/compass.ocean.plot.plot_vertical_grid.html#compass.ocean.plot.plot_vertical_grid" title="compass.ocean.plot.plot_vertical_grid"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.ocean.plot.plot_vertical_grid()</span></code></a> plot the vertical grid in
3 ways: layer mid-depth vs. vertical index; layer mid-depth vs. layer thickness;
and layer thickness vs. vertical index.  Again, this provides a quick sanity
check that the grid has the expected bounds (both in thickness and in depth)
and number of layers.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../framework.html" class="btn btn-neutral float-right" title="Framework" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="test_groups/ziso.html" class="btn btn-neutral float-left" title="ziso" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright Copyright (c) 2013-2021,  Los Alamos National Security, LLC (LANS) (Ocean: LA-CC-13-047;Land Ice: LA-CC-13-117) and the University Corporation for Atmospheric Research (UCAR)..

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>