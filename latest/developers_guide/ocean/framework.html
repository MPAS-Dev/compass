

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ocean framework &mdash; compass latest documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=c6e86fd7"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Framework" href="../framework.html" />
    <link rel="prev" title="ziso" href="test_groups/ziso.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            compass
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User's guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/quick_start.html">Quick Start for Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/test_cases.html">Test Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/config_files.html">Config Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/test_suites.html">Test Suites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/landice/index.html">Landice core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/ocean/index.html">Ocean core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/machines/index.html">Machines</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer's guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quick_start.html">Quick Start for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../command_line.html">Command-line interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../organization.html">Organization of Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../landice/index.html">Landice core</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Ocean core</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="test_groups/index.html">Test groups</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Ocean framework</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#namelist-replacements-and-streams-files">Namelist replacements and streams files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#vertical-coordinate">Vertical coordinate</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mesh">Mesh</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#remapping-topography">Remapping Topography</a></li>
<li class="toctree-l4"><a class="reference internal" href="#culling-meshes">Culling Meshes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#including-a-floodplain">Including a Floodplain</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#haney-number">Haney number</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ice-shelf-cavities">Ice-shelf cavities</a></li>
<li class="toctree-l3"><a class="reference internal" href="#particles">Particles</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plotting">Plotting</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../framework.html">Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../machines/index.html">Machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../building_docs.html">Building the Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploying_spack.html">Deploying a new spack environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../design_docs/index.html">Design Documents</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/dev_add_test_group.html">Developer Tutorial: Adding a new test group</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/dev_add_rrm.html">Developer Tutorial: Adding a new ocean/sea ice regionally refined mesh (RRM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/dev_add_param_study.html">Developer Tutorial: Adding a parameter study</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/dev_porting_legacy.html">Developer Tutorial: Porting a legacy COMPASS test group</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Glossary</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Versions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../versions.html">Code and Documentation Versions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">compass</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Ocean core</a></li>
      <li class="breadcrumb-item active">Ocean framework</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/developers_guide/ocean/framework.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="ocean-framework">
<span id="dev-ocean-framework"></span><h1>Ocean framework<a class="headerlink" href="#ocean-framework" title="Link to this heading"></a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">ocean</span></code> core contains a small amount of shared framework code that we
expect to expand in the future as new test cases are added.</p>
<section id="namelist-replacements-and-streams-files">
<h2>Namelist replacements and streams files<a class="headerlink" href="#namelist-replacements-and-streams-files" title="Link to this heading"></a></h2>
<p>The modules <code class="docutils literal notranslate"><span class="pre">compass.ocean.namelists</span></code> and <code class="docutils literal notranslate"><span class="pre">compass.ocean.streams</span></code> contain
namelist replacements and streams files that are similar to core-level
templates in <a class="reference internal" href="../../index.html#legacy-compass"><span class="std std-ref">Legacy COMPASS</span></a>.  Current templates are for adjusting sea
surface height in ice-shelf cavities, and outputting variables related to
frazil ice and land-ice fluxes.</p>
</section>
<section id="vertical-coordinate">
<span id="dev-ocean-framework-vertical"></span><h2>Vertical coordinate<a class="headerlink" href="#vertical-coordinate" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">compass.ocean.vertical</span></code> module provides support for computing general
vertical coordinates for MPAS-Ocean test cases.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">compass.ocean.vertical.grid_1d</span></code> module provides 1D vertical
coordinates.  To create 1D vertical grids, test cases should call
<a class="reference internal" href="generated/compass.ocean.vertical.grid_1d.generate_1d_grid.html#compass.ocean.vertical.grid_1d.generate_1d_grid" title="compass.ocean.vertical.grid_1d.generate_1d_grid"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.ocean.vertical.grid_1d.generate_1d_grid()</span></code></a> with the desired
config options set in the <code class="docutils literal notranslate"><span class="pre">vertical_grid</span></code> section (as described in
<a class="reference internal" href="../../users_guide/ocean/framework/vertical.html#ocean-vertical"><span class="std std-ref">Vertical coordinate</span></a>).</p>
<p>The z-level and z-star coordinates are also controlled by config options from
this section of the config file. The function
<a class="reference internal" href="generated/compass.ocean.vertical.init_vertical_coord.html#compass.ocean.vertical.init_vertical_coord" title="compass.ocean.vertical.init_vertical_coord"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.ocean.vertical.init_vertical_coord()</span></code></a> can be used to compute
<code class="docutils literal notranslate"><span class="pre">minLevelCell</span></code>, <code class="docutils literal notranslate"><span class="pre">maxLevelCell</span></code>, <code class="docutils literal notranslate"><span class="pre">cellMask</span></code>, <code class="docutils literal notranslate"><span class="pre">layerThickness</span></code>, <code class="docutils literal notranslate"><span class="pre">zMid</span></code>,
and <code class="docutils literal notranslate"><span class="pre">restingThickness</span></code> variables for <a class="reference internal" href="../../users_guide/ocean/framework/vertical.html#ocean-z-level"><span class="std std-ref">z-level</span></a> and
<a class="reference internal" href="../../users_guide/ocean/framework/vertical.html#ocean-z-star"><span class="std std-ref">z-star</span></a> coordinates using the <code class="docutils literal notranslate"><span class="pre">ssh</span></code> and <code class="docutils literal notranslate"><span class="pre">bottomDepth</span></code> as well
as config options from <code class="docutils literal notranslate"><span class="pre">vertical_grid</span></code>.</p>
</section>
<section id="mesh">
<span id="dev-ocean-framework-mesh"></span><h2>Mesh<a class="headerlink" href="#mesh" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">compass.ocean.mesh</span></code> package includes modules for modifying spherical
ocean meshes shared across test groups.</p>
<section id="remapping-topography">
<span id="dev-ocean-framework-remap-topography"></span><h3>Remapping Topography<a class="headerlink" href="#remapping-topography" title="Link to this heading"></a></h3>
<p>After building a base spherical mesh (see <a class="reference internal" href="../framework.html#dev-spherical-meshes"><span class="std std-ref">Spherical Meshes</span></a>),
the global ocean <a class="reference internal" href="test_groups/global_ocean.html#dev-ocean-global-ocean-mesh"><span class="std std-ref">mesh test case</span></a> includes a step for
remapping topography data (bathymetry, ocean mask, land-ice draft, land-ice
thickness, grounded and floating land-ice masks, etc.) to the MPAS mesh.  This
step is controlled by config options described in
<a class="reference internal" href="../../users_guide/ocean/framework/mesh.html#ocean-remap-topography"><span class="std std-ref">Remapping topography</span></a>.</p>
<p>By default, the step creates a partitioned SCRIP file and generates a mapping
file using the <a class="reference external" href="https://github.com/ClimateGlobalChange/tempestremap">tempest</a>
and <a class="reference external" href="https://sigma.mcs.anl.gov/moab-library/">MOAB</a>
tools. It can optionally use ESMF’s
<a class="reference external" href="https://earthsystemmodeling.org/docs/release/ESMF_8_4_1/ESMF_refdoc/node3.html#SECTION03020000000000000000">ESMF_RegridWeightGen</a>
tool to generate a mapping files. In either case, the step then uses
<a class="reference external" href="https://nco.sourceforge.net/nco.html#ncremap-netCDF-Remapper">ncremap</a>
to perform remapping to the MPAS mesh.  Finally, it renames the
topography variables to the following names, expected in MPAS-Ocean’s init mode
for the global ocean:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rename</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;bathymetry_var&#39;</span><span class="p">:</span> <span class="s1">&#39;bed_elevation&#39;</span><span class="p">,</span>
          <span class="s1">&#39;ice_draft_var&#39;</span><span class="p">:</span> <span class="s1">&#39;landIceDraftObserved&#39;</span><span class="p">,</span>
          <span class="s1">&#39;ice_thickness_var&#39;</span><span class="p">:</span> <span class="s1">&#39;landIceThkObserved&#39;</span><span class="p">,</span>
          <span class="s1">&#39;ice_frac_var&#39;</span><span class="p">:</span> <span class="s1">&#39;landIceFracObserved&#39;</span><span class="p">,</span>
          <span class="s1">&#39;grounded_ice_frac_var&#39;</span><span class="p">:</span> <span class="s1">&#39;landIceGroundedFracObserved&#39;</span><span class="p">,</span>
          <span class="s1">&#39;ocean_frac_var&#39;</span><span class="p">:</span> <span class="s1">&#39;oceanFracObserved&#39;</span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="culling-meshes">
<span id="dev-ocean-framework-cull-mesh"></span><h3>Culling Meshes<a class="headerlink" href="#culling-meshes" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">compass.ocean.mesh.cull</span></code> module is for culling land cells from
global ocean meshes.</p>
<p>The class <a class="reference internal" href="generated/compass.ocean.mesh.cull.CullMeshStep.html#compass.ocean.mesh.cull.CullMeshStep" title="compass.ocean.mesh.cull.CullMeshStep"><code class="xref py py-class docutils literal notranslate"><span class="pre">compass.ocean.mesh.cull.CullMeshStep</span></code></a> culls out land
cells by calling <code class="docutils literal notranslate"><span class="pre">cull_mesh()</span></code>.</p>
<p><a class="reference internal" href="generated/compass.ocean.mesh.cull.cull_mesh.html#compass.ocean.mesh.cull.cull_mesh" title="compass.ocean.mesh.cull.cull_mesh"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.ocean.mesh.cull.cull_mesh()</span></code></a> uses a number of
capabilities from <a class="reference external" href="http://mpas-dev.github.io/MPAS-Tools/stable/">MPAS-Tools</a>
and <a class="reference external" href="http://mpas-dev.github.io/geometric_features/stable/">geometric_features</a>
to cull the mesh.  It performs the following steps:</p>
<ol class="arabic simple">
<li><p>combining Natural Earth land coverage north of 60S with Antarctic
ice coverage or grounded ice coverage from BedMachineAntarctica</p></li>
<li><p>combining transects defining critical passages (if
<code class="docutils literal notranslate"><span class="pre">with_critical_passages=True</span></code>)</p></li>
<li><p>combining points used to seed a flood fill of the global ocean.</p></li>
<li><p>create masks from land coverage</p></li>
<li><p>add land-locked cells to land coverage mask.</p></li>
<li><p>create masks from transects (if <code class="docutils literal notranslate"><span class="pre">with_critical_passages=True</span></code>)</p></li>
<li><p>cull cells based on land coverage but with transects present</p></li>
<li><p>create flood-fill mask based on seeds</p></li>
<li><p>cull cells based on flood-fill mask</p></li>
<li><p>create masks from transects on the final culled mesh (if
<code class="docutils literal notranslate"><span class="pre">with_critical_passages=True</span></code>)</p></li>
</ol>
</section>
<section id="including-a-floodplain">
<span id="dev-ocean-framework-floodplain"></span><h3>Including a Floodplain<a class="headerlink" href="#including-a-floodplain" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">compass.ocean.mesh.floodplain</span></code> module is for adding support for a
floodplain to a base global ocean mesh.</p>
<p>The class <a class="reference internal" href="generated/compass.ocean.mesh.floodplain.FloodplainMeshStep.html#compass.ocean.mesh.floodplain.FloodplainMeshStep" title="compass.ocean.mesh.floodplain.FloodplainMeshStep"><code class="xref py py-class docutils literal notranslate"><span class="pre">compass.ocean.mesh.floodplain.FloodplainMeshStep</span></code></a>
descends from <a class="reference internal" href="../generated/compass.mesh.QuasiUniformSphericalMeshStep.html#compass.mesh.QuasiUniformSphericalMeshStep" title="compass.mesh.QuasiUniformSphericalMeshStep"><code class="xref py py-class docutils literal notranslate"><span class="pre">compass.mesh.QuasiUniformSphericalMeshStep</span></code></a>, adding
an attribute:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">self.preserve_floodplain</span></code></dt><dd><p>A <code class="docutils literal notranslate"><span class="pre">bool</span></code> defining whether the mesh includes land cells</p>
</dd>
</dl>
<p>and including topography in the base mesh from the
<cite>SRTM15_plus_earth_relief_15s.nc</cite> file in the <cite>bathymetry_database</cite>.  The
<code class="docutils literal notranslate"><span class="pre">run()</span></code> method uses the config option:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="c1"># options for spherical meshes</span>
<span class="k">[spherical_mesh]</span>

<span class="c1"># Elevation threshold to use for including land cells</span>
<span class="na">floodplain_elevation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">10.0</span>
</pre></div>
</div>
<p>to determine the elevation of the floodplain to maintain above sea level.
The bathymetry and the floodplain are added to the mesh using
<code class="xref py py-func docutils literal notranslate"><span class="pre">mpas_tools.ocean.inject_bathymetry()</span></code> and
<code class="xref py py-func docutils literal notranslate"><span class="pre">mpas_tools.ocean.inject_preserve_floodplain()</span></code>, respectively.</p>
</section>
</section>
<section id="haney-number">
<span id="dev-ocean-framework-haney"></span><h2>Haney number<a class="headerlink" href="#haney-number" title="Link to this heading"></a></h2>
<p>The module <code class="docutils literal notranslate"><span class="pre">compass.ocean.haney</span></code> defines a function
<a class="reference internal" href="generated/compass.ocean.haney.compute_haney_number.html#compass.ocean.haney.compute_haney_number" title="compass.ocean.haney.compute_haney_number"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.ocean.haney.compute_haney_number()</span></code></a> for computing the Haney
number (<a class="reference external" href="https://doi.org/10.1175/1520-0485(1991)021%3C0610:OTPGFO%3E2.0.CO;2">Haney 1991</a>).
The Haney number is a measure of how large pressure-gradient errors are likely
to be based on how thin and tilted the model layers have become.</p>
<div class="math notranslate nohighlight">
\[r_{x1}(e,k+1/2) =
    \frac{\left|z_\textrm{mid}(c_2, k) − z_\textrm{mid}(c_1 , k)
                + z_\textrm{mid}(c_2, k+1) − z_\textrm{mid}(c_1, k+1)\right|}
         {z_\textrm{mid}(c_2, k) − z_\textrm{mid}(c_2 , k+1)
          + z_\textrm{mid}(c_1, k) − z_\textrm{mid}(c_1, k+1)},\]</div>
<p>where the computation is centered at edge <span class="math notranslate nohighlight">\(e\)</span> and at the interface
between layers <span class="math notranslate nohighlight">\(k\)</span> and <span class="math notranslate nohighlight">\(k+1\)</span>, adjacent to cells <span class="math notranslate nohighlight">\(c_1\)</span> and
<span class="math notranslate nohighlight">\(c_2\)</span>.  The elevation of the middle of layer <span class="math notranslate nohighlight">\(k\)</span> at the center of
cell <span class="math notranslate nohighlight">\(c\)</span> is <span class="math notranslate nohighlight">\(z_\textrm{mid}(c, k)\)</span>.</p>
<figure class="align-center" id="id1">
<a class="reference internal image-reference" href="../../_images/haney.png"><img alt="Haney number" src="../../_images/haney.png" style="width: 403px;" />
</a>
<figcaption>
<p><span class="caption-text">The locations of four adjacent cell centers used in the computation of the
Haney number (and the horizontal pressure-gradient force).</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="ice-shelf-cavities">
<span id="dev-ocean-framework-iceshelf"></span><h2>Ice-shelf cavities<a class="headerlink" href="#ice-shelf-cavities" title="Link to this heading"></a></h2>
<p>The module <code class="docutils literal notranslate"><span class="pre">compass.ocean.iceshelf</span></code> defines two functions that are used to
set up domains with ice-shelf cavities.</p>
<p><a class="reference internal" href="generated/compass.ocean.iceshelf.compute_land_ice_pressure_and_draft.html#compass.ocean.iceshelf.compute_land_ice_pressure_and_draft" title="compass.ocean.iceshelf.compute_land_ice_pressure_and_draft"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.ocean.iceshelf.compute_land_ice_pressure_and_draft()</span></code></a>
computes the <code class="docutils literal notranslate"><span class="pre">landIcePressure</span></code> and <code class="docutils literal notranslate"><span class="pre">landIceDraft</span></code> fields based on the
sea-surface height (SSH) and a reference density (typically the the Boussinesq
reference density).</p>
<p><a class="reference internal" href="generated/compass.ocean.iceshelf.adjust_ssh.html#compass.ocean.iceshelf.adjust_ssh" title="compass.ocean.iceshelf.adjust_ssh"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.ocean.iceshelf.adjust_ssh()</span></code></a> performs a series of forward
runs with MPAS-Ocean to detect and correct imbalances between the SSH and the
land-ice pressure.  In each forward run, the SSH is allowed to evolve forward
in time for a short period (typically 1 hour), then the resulting change in
SSH is translated into a compensating change in land-ice pressure that is
expected to reduce the change in SSH.  The initial land-ice pressure is updated
accordingly and the process is repeated for a fixed number of iterations,
typically leading to smaller and smaller changes in the land-ice pressure.
This process does not completely eliminate the dynamical adjustment of the
ocean to the overlying weight of the ice shelf but it tends to reduce it
substantially and to prevent it from causing numerical instabilities.  This
procedure is also largely agnostic to the equation of state being used or the
method for implementing the horizontal pressure-gradient force.</p>
</section>
<section id="particles">
<span id="dev-ocean-framework-particles"></span><h2>Particles<a class="headerlink" href="#particles" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">compass.ocean.particles</span></code> module contains functionality for initializing
particles for the <a class="reference external" href="https://doi.org/10.1175/JPO-D-14-0260.1">LIGHT framework</a>.</p>
<p><a class="reference internal" href="generated/compass.ocean.particles.write.html#compass.ocean.particles.write" title="compass.ocean.particles.write"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.ocean.particles.write()</span></code></a> creates an initial condition for
particles partitioned across cores.  There are 3 possible particle types (or
<code class="docutils literal notranslate"><span class="pre">all</span></code> to indicate that all 3 types will be generated):</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">buoyancy</span></code></dt><dd><p>Particles are constrained to buoyancy (isopycnal) surfaces</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">passive</span></code></dt><dd><p>Particles move both horizontally and vertically as passive tracers</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">surface</span></code></dt><dd><p>Particles are constrained to the top ocean level</p>
</dd>
</dl>
<p><a class="reference internal" href="generated/compass.ocean.particles.remap_particles.html#compass.ocean.particles.remap_particles" title="compass.ocean.particles.remap_particles"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.ocean.particles.remap_particles()</span></code></a> is used to remap particles
onto a new grid decomposition.  This might be useful, for example, if you wish
to change the number of cores that a particle initial condition should run on.</p>
</section>
<section id="plotting">
<span id="dev-ocean-framework-plot"></span><h2>Plotting<a class="headerlink" href="#plotting" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">compass.ocean.plot</span></code> contains functionality for plotting the initial
state and 1D vertical grid.</p>
<p><a class="reference internal" href="generated/compass.ocean.plot.plot_initial_state.html#compass.ocean.plot.plot_initial_state" title="compass.ocean.plot.plot_initial_state"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.ocean.plot.plot_initial_state()</span></code></a> creates histogram plots of
salinity, temperature, bottom depth, <code class="docutils literal notranslate"><span class="pre">maxLevelCell</span></code>, layer thickness and the
Haney number from global initial condition.  This is useful for providing a
quick sanity check that these values have the expected range and distribution,
based on previous meshes.</p>
<p><a class="reference internal" href="generated/compass.ocean.plot.plot_vertical_grid.html#compass.ocean.plot.plot_vertical_grid" title="compass.ocean.plot.plot_vertical_grid"><code class="xref py py-func docutils literal notranslate"><span class="pre">compass.ocean.plot.plot_vertical_grid()</span></code></a> plot the vertical grid in
3 ways: layer mid-depth vs. vertical index; layer mid-depth vs. layer thickness;
and layer thickness vs. vertical index.  Again, this provides a quick sanity
check that the grid has the expected bounds (both in thickness and in depth)
and number of layers.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="test_groups/ziso.html" class="btn btn-neutral float-left" title="ziso" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../framework.html" class="btn btn-neutral float-right" title="Framework" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Copyright (c) 2013-2021,  Los Alamos National Security, LLC (LANS) (Ocean: LA-CC-13-047;Land Ice: LA-CC-13-117) and the University Corporation for Atmospheric Research (UCAR)..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>