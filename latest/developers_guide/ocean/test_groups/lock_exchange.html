

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>lock_exchange &mdash; compass latest documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=c6e86fd7"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="merry_go_round" href="merry_go_round.html" />
    <link rel="prev" title="isomip_plus" href="isomip_plus.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            compass
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User's guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users_guide/quick_start.html">Quick Start for Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../users_guide/test_cases.html">Test Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../users_guide/config_files.html">Config Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../users_guide/test_suites.html">Test Suites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../users_guide/landice/index.html">Landice core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../users_guide/ocean/index.html">Ocean core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../users_guide/machines/index.html">Machines</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer's guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../quick_start.html">Quick Start for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../command_line.html">Command-line interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../organization.html">Organization of Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../landice/index.html">Landice core</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Ocean core</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Test groups</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="baroclinic_channel.html">baroclinic_channel</a></li>
<li class="toctree-l3"><a class="reference internal" href="baroclinic_gyre.html">baroclinic_gyre</a></li>
<li class="toctree-l3"><a class="reference internal" href="buttermilk_bay.html">buttermilk_bay</a></li>
<li class="toctree-l3"><a class="reference internal" href="dam_break.html">dam_break</a></li>
<li class="toctree-l3"><a class="reference internal" href="drying_slope.html">drying_slope</a></li>
<li class="toctree-l3"><a class="reference internal" href="global_convergence.html">global_convergence</a></li>
<li class="toctree-l3"><a class="reference internal" href="global_ocean.html">global_ocean</a></li>
<li class="toctree-l3"><a class="reference internal" href="gotm.html">gotm</a></li>
<li class="toctree-l3"><a class="reference internal" href="hurricane.html">hurricane</a></li>
<li class="toctree-l3"><a class="reference internal" href="ice_shelf_2d.html">ice_shelf_2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="internal_wave.html">internal_wave</a></li>
<li class="toctree-l3"><a class="reference internal" href="isomip_plus.html">isomip_plus</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">lock_exchange</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#framework">framework</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="merry_go_round.html">merry_go_round</a></li>
<li class="toctree-l3"><a class="reference internal" href="nonhydro.html">nonhydro</a></li>
<li class="toctree-l3"><a class="reference internal" href="overflow.html">overflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="parabolic_bowl.html">parabolic_bowl</a></li>
<li class="toctree-l3"><a class="reference internal" href="planar_convergence.html">planar_convergence</a></li>
<li class="toctree-l3"><a class="reference internal" href="soma.html">soma</a></li>
<li class="toctree-l3"><a class="reference internal" href="sphere_transport.html">sphere_transport</a></li>
<li class="toctree-l3"><a class="reference internal" href="spherical_harmonic_transform.html">spherical_harmonic_transform</a></li>
<li class="toctree-l3"><a class="reference internal" href="tides.html">tides</a></li>
<li class="toctree-l3"><a class="reference internal" href="utility.html">utility</a></li>
<li class="toctree-l3"><a class="reference internal" href="ziso.html">ziso</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../framework.html">Ocean framework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../framework.html">Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../machines/index.html">Machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../building_docs.html">Building the Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../deploying_spack.html">Deploying a new spack environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../design_docs/index.html">Design Documents</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/dev_add_test_group.html">Developer Tutorial: Adding a new test group</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/dev_add_rrm.html">Developer Tutorial: Adding a new ocean/sea ice regionally refined mesh (RRM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/dev_add_param_study.html">Developer Tutorial: Adding a parameter study</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/dev_porting_legacy.html">Developer Tutorial: Porting a legacy COMPASS test group</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Glossary</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Versions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../versions.html">Code and Documentation Versions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">compass</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Ocean core</a></li>
          <li class="breadcrumb-item"><a href="index.html">Test groups</a></li>
      <li class="breadcrumb-item active">lock_exchange</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/developers_guide/ocean/test_groups/lock_exchange.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="lock-exchange">
<span id="dev-ocean-lock-exchange"></span><h1>lock_exchange<a class="headerlink" href="#lock-exchange" title="Link to this heading"></a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">lock_exchange</span></code> test group
(<a class="reference internal" href="../generated/compass.ocean.tests.lock_exchange.LockExchange.html#compass.ocean.tests.lock_exchange.LockExchange" title="compass.ocean.tests.lock_exchange.LockExchange"><code class="xref py py-class docutils literal notranslate"><span class="pre">compass.ocean.tests.lock_exchange.LockExchange</span></code></a>)
implements two test cases (see <a class="reference internal" href="../../../users_guide/ocean/test_groups/lock_exchange.html#ocean-lock-exchange"><span class="std std-ref">lock_exchange</span></a>)
which represent a lock exchange scenario, i.e. two fluids
with different densities that interact over time.
The first test uses the standard hydrostatic ocean model,
whereas the second one uses the nonhydrostatic version.
Here, we describe the shared framework for this test group
and the two test cases.</p>
<section id="framework">
<span id="dev-ocean-lock-exchange-framework"></span><h2>framework<a class="headerlink" href="#framework" title="Link to this heading"></a></h2>
<p>The shared config options for the <code class="docutils literal notranslate"><span class="pre">lock_exchange</span></code> test group
are described in <a class="reference internal" href="../../../users_guide/ocean/test_groups/lock_exchange.html#ocean-lock-exchange"><span class="std std-ref">lock_exchange</span></a> in the User’s Guide.</p>
<p>Additionally, the test group has a shared <code class="docutils literal notranslate"><span class="pre">namelist.forward</span></code> file with
a few common namelist options related to time step, run duration, viscosity,
and drag, as well as a shared <code class="docutils literal notranslate"><span class="pre">streams.forward</span></code> file that defines <code class="docutils literal notranslate"><span class="pre">mesh</span></code>,
<code class="docutils literal notranslate"><span class="pre">input</span></code>, and <code class="docutils literal notranslate"><span class="pre">output</span></code> streams.</p>
<section id="initial-state">
<h3>initial_state<a class="headerlink" href="#initial-state" title="Link to this heading"></a></h3>
<p>The class <a class="reference internal" href="../generated/compass.ocean.tests.lock_exchange.initial_state.InitialState.html#compass.ocean.tests.lock_exchange.initial_state.InitialState" title="compass.ocean.tests.lock_exchange.initial_state.InitialState"><code class="xref py py-class docutils literal notranslate"><span class="pre">compass.ocean.tests.lock_exchange.initial_state.InitialState</span></code></a>
sets up the initial state for the two test case.</p>
<p>First, a planar mesh is generated using <a class="reference external" href="http://mpas-dev.github.io/MPAS-Tools/master/generated/mpas_tools.planar_hex.make_planar_hex_mesh.html#mpas_tools.planar_hex.make_planar_hex_mesh" title="(in mpas_tools v0.36.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">mpas_tools.planar_hex.make_planar_hex_mesh()</span></code></a>.
Then, the mesh is culled to remove periodicity in the x direction.  A vertical grid is
generated, with 100 layers of 0.001m thickness each by default.  Finally, the initial
density profile is computed along with temperature, uniform salinity and zero initial
velocity.</p>
</section>
<section id="forward">
<h3>forward<a class="headerlink" href="#forward" title="Link to this heading"></a></h3>
<p>The class <a class="reference internal" href="../generated/compass.ocean.tests.lock_exchange.forward.Forward.html#compass.ocean.tests.lock_exchange.forward.Forward" title="compass.ocean.tests.lock_exchange.forward.Forward"><code class="xref py py-class docutils literal notranslate"><span class="pre">compass.ocean.tests.lock_exchange.forward.Forward</span></code></a>
defines a step for running MPAS-Ocean from the initial condition produced in
the <code class="docutils literal notranslate"><span class="pre">initial_state</span></code> step. Namelist and streams files are generate during
<code class="docutils literal notranslate"><span class="pre">__init__()</span></code> and MPAS-Ocean is run (including updating PIO namelist options
and generating a graph partition) in <code class="docutils literal notranslate"><span class="pre">run()</span></code>. The simulation (either
hydrostatic or nonhydrostatic) is run on 16 cores using the RK4 time-stepping
scheme and has a run duration of 5s. The <code class="docutils literal notranslate"><span class="pre">namelist.forward</span></code> file has a few
common namelist options for the two test cases related to run duration,
time-stepping scheme, horizontal and vertical momentum, and tracer diffusion.
The two cases have a shared <code class="docutils literal notranslate"><span class="pre">streams.forward</span></code> file that defines
<code class="docutils literal notranslate"><span class="pre">mesh</span></code>, <code class="docutils literal notranslate"><span class="pre">input</span></code>, and <code class="docutils literal notranslate"><span class="pre">output</span></code> streams.</p>
</section>
<section id="visualize">
<h3>visualize<a class="headerlink" href="#visualize" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">visualize</span></code> step defined by
<a class="reference internal" href="../generated/compass.ocean.tests.lock_exchange.visualize.Visualize.html#compass.ocean.tests.lock_exchange.visualize.Visualize" title="compass.ocean.tests.lock_exchange.visualize.Visualize"><code class="xref py py-class docutils literal notranslate"><span class="pre">compass.ocean.tests.lock_exchange.visualize.Visualize</span></code></a>
makes a plot of the densitiy profile at time t = 5s.</p>
<section id="hydro">
<span id="dev-ocean-lock-exchange-hydro"></span><h4>hydro<a class="headerlink" href="#hydro" title="Link to this heading"></a></h4>
<p>This test uses the standard hydrostatic model to describe the interaction
over time of two basins of water with different densities. After the creation
of the mesh and initial conditions, a hydrostatic simulation is run.
The density plot shows that the density fronts cannot develop in the upper
and lower layer. This happens because of the hydrostatic assumption, which
prevents the generation of the Kelvin-Helmholtz instability.</p>
</section>
<section id="nonhydro">
<span id="dev-ocean-lock-exchange-nonhydro"></span><h4>nonhydro<a class="headerlink" href="#nonhydro" title="Link to this heading"></a></h4>
<p>This test uses the nonhydrostatic model to describe the interaction
over time of two basins of water with different densities. After the creation
of the mesh and initial conditions, a nonhydrostatic simulation is run.
The file <code class="docutils literal notranslate"><span class="pre">namelist.nonhydro</span></code> defines the PETSc solver, preconditioner
and tolerances used for the solution of the nonhydrostatic elliptic problem.
The density plot shows that a Kelvin-Helmholtz instability generates with the
nonhydrostatic model, which causes vigorous turbulent mixing to develop on the
interface between high and low-density water.</p>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="isomip_plus.html" class="btn btn-neutral float-left" title="isomip_plus" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="merry_go_round.html" class="btn btn-neutral float-right" title="merry_go_round" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Copyright (c) 2013-2021,  Los Alamos National Security, LLC (LANS) (Ocean: LA-CC-13-047;Land Ice: LA-CC-13-117) and the University Corporation for Atmospheric Research (UCAR)..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>