

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Machines &mdash; compass latest documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Anvil" href="anvil.html" />
    <link rel="prev" title="Framework" href="../framework.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> compass
          

          
          </a>

          
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User's guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/quick_start.html">Quick Start for Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/test_cases.html">Test Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/config_files.html">Config Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/test_suites.html">Test Suites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/landice/index.html">Landice core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/ocean/index.html">Ocean core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/machines/index.html">Machines</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer's guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quick_start.html">Quick Start for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../command_line.html">Command-line interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../organization.html">Organization of Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../landice/index.html">Landice core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ocean/index.html">Ocean core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../framework.html">Framework</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Machines</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#supported-machines">Supported Machines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="anvil.html">Anvil</a></li>
<li class="toctree-l3"><a class="reference internal" href="badger.html">Badger</a></li>
<li class="toctree-l3"><a class="reference internal" href="chrysalis.html">Chrysalis</a></li>
<li class="toctree-l3"><a class="reference internal" href="compy.html">CompyMcNodeFace</a></li>
<li class="toctree-l3"><a class="reference internal" href="cori.html">Cori</a></li>
<li class="toctree-l3"><a class="reference internal" href="grizzly.html">Grizzly</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#other-machines">Other Machines</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../docs.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../building_docs.html">Building the Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../design_docs/index.html">Design Documents</a></li>
</ul>
<p class="caption"><span class="caption-text">Glossary</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>
<p class="caption"><span class="caption-text">Versions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../versions.html">Code and Documentation Versions</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">compass</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Machines</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/developers_guide/machines/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="machines">
<span id="dev-machines"></span><h1>Machines<a class="headerlink" href="#machines" title="Permalink to this headline">¶</a></h1>
<p>One of the major advantages of <code class="docutils literal notranslate"><span class="pre">compass</span></code> over <a class="reference internal" href="../../index.html#legacy-compass"><span class="std std-ref">Legacy COMPASS</span></a> is that it
attempts to be aware of the capabilities of the machine it is running on.  This
is a particular advantage for so-called “supported” machines with a config file
defined for them in the <code class="docutils literal notranslate"><span class="pre">compass</span></code> package.  But even for “unknown” machines,
it is not difficult to set a few config options in your user config file to
describe your machine.  Then, <code class="docutils literal notranslate"><span class="pre">compass</span></code> can use this data to make sure test
cases are configured in a way that is appropriate for your machine.</p>
<div class="section" id="supported-machines">
<span id="dev-supported-machines"></span><h2>Supported Machines<a class="headerlink" href="#supported-machines" title="Permalink to this headline">¶</a></h2>
<p>We have activation scripts, typically for two compiler flavors, on each
supported machine.  The easiest way to load these for a developer is to run
the following in the root of the local clone of the compass repo:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span> ./load/load_compass_env.sh <span class="o">[</span>-m &lt;machine&gt;<span class="o">]</span> <span class="o">[</span>-c &lt;compiler&gt;<span class="o">]</span>
</pre></div>
</div>
<p>This will then source an appropriate script that will activate the compass
conda environment, load the compiler and MPI modules, and set environment
variables needed compile MPAS.</p>
<p>If you are on a login node, the script should automatically recognize what
machine you are on.  You can supply the machine name with <code class="docutils literal notranslate"><span class="pre">-m</span> <span class="pre">&lt;machine&gt;</span></code> if
you run into trouble with the automatic recognition (e.g. if you’re setting
up test cases on a compute node).</p>
<p>If you do not supply a compiler set with <code class="docutils literal notranslate"><span class="pre">-c</span></code>, you will get the default
compiler for each machine.  Typically, we only support one MPI flavor per
compiler, so you should not need to specify which MPI version to use.  This
follows automatically from the choice of compilers.</p>
<p>To list the available compilers and MPI libraries on a machine, run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span> ./load/load_compass_env.sh --list
</pre></div>
</div>
<p>You will see something like:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Default compiler and MPI library:
  -c intel -i impi

Available compilers and MPI libraries:
  -c intel -i impi
  -c gnu -i mvapich
  -c intel -i mvapich
</pre></div>
</div>
<p>After loading this environment, you can set up test cases or test suites, and
a link <code class="docutils literal notranslate"><span class="pre">load_compass_env.sh</span></code> will be included in each suite or test case
work directory.  This is a link to a specific activation script for that
machine and compiler (so not a link to <code class="docutils literal notranslate"><span class="pre">load/load_compass_env.sh</span></code>, it just
happens to be given the same name).  You can can source this file on a
compute node (e.g. in a job script) to get the right compass conda environment,
compilers, MPI libraries and environment variables for running MPAS.</p>
<p>Below are specifics for each supported machine</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="anvil.html">Anvil</a></li>
<li class="toctree-l1"><a class="reference internal" href="badger.html">Badger</a></li>
<li class="toctree-l1"><a class="reference internal" href="chrysalis.html">Chrysalis</a></li>
<li class="toctree-l1"><a class="reference internal" href="compy.html">CompyMcNodeFace</a></li>
<li class="toctree-l1"><a class="reference internal" href="cori.html">Cori</a></li>
<li class="toctree-l1"><a class="reference internal" href="grizzly.html">Grizzly</a></li>
</ul>
</div>
</div>
<div class="section" id="other-machines">
<span id="dev-other-machines"></span><h2>Other Machines<a class="headerlink" href="#other-machines" title="Permalink to this headline">¶</a></h2>
<p>For a discussion on this, see the user’s guid one <a class="reference internal" href="../../users_guide/machines/index.html#other-machines"><span class="std std-ref">Other Machines</span></a>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="anvil.html" class="btn btn-neutral float-right" title="Anvil" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../framework.html" class="btn btn-neutral float-left" title="Framework" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright Copyright (c) 2013-2021,  Los Alamos National Security, LLC (LANS) (Ocean: LA-CC-13-047;Land Ice: LA-CC-13-117) and the University Corporation for Atmospheric Research (UCAR)..

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>