

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>nonhydro &mdash; compass latest documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=c6e86fd7"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="overflow" href="overflow.html" />
    <link rel="prev" title="merry_go_round" href="merry_go_round.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            compass
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User's guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../quick_start.html">Quick Start for Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../test_cases.html">Test Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../config_files.html">Config Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../test_suites.html">Test Suites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../landice/index.html">Landice core</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Ocean core</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Test groups</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="baroclinic_channel.html">baroclinic_channel</a></li>
<li class="toctree-l3"><a class="reference internal" href="baroclinic_gyre.html">baroclinic_gyre</a></li>
<li class="toctree-l3"><a class="reference internal" href="buttermilk_bay.html">buttermilk_bay</a></li>
<li class="toctree-l3"><a class="reference internal" href="dam_break.html">dam_break</a></li>
<li class="toctree-l3"><a class="reference internal" href="drying_slope.html">drying_slope</a></li>
<li class="toctree-l3"><a class="reference internal" href="global_convergence.html">global_convergence</a></li>
<li class="toctree-l3"><a class="reference internal" href="global_ocean.html">global_ocean</a></li>
<li class="toctree-l3"><a class="reference internal" href="gotm.html">gotm</a></li>
<li class="toctree-l3"><a class="reference internal" href="hurricane.html">hurricane</a></li>
<li class="toctree-l3"><a class="reference internal" href="ice_shelf_2d.html">ice_shelf_2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="internal_wave.html">internal_wave</a></li>
<li class="toctree-l3"><a class="reference internal" href="isomip_plus.html">isomip_plus</a></li>
<li class="toctree-l3"><a class="reference internal" href="lock_exchange.html">lock_exchange</a></li>
<li class="toctree-l3"><a class="reference internal" href="merry_go_round.html">merry_go_round</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">nonhydro</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#stratified-seiche">stratified_seiche</a></li>
<li class="toctree-l4"><a class="reference internal" href="#internal-wave">internal_wave</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="overflow.html">overflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="parabolic_bowl.html">parabolic_bowl</a></li>
<li class="toctree-l3"><a class="reference internal" href="planar_convergence.html">planar_convergence</a></li>
<li class="toctree-l3"><a class="reference internal" href="soma.html">soma</a></li>
<li class="toctree-l3"><a class="reference internal" href="sphere_transport.html">sphere_transport</a></li>
<li class="toctree-l3"><a class="reference internal" href="spherical_harmonic_transform.html">spherical_harmonic_transform</a></li>
<li class="toctree-l3"><a class="reference internal" href="tides.html">tides</a></li>
<li class="toctree-l3"><a class="reference internal" href="utility.html">utility</a></li>
<li class="toctree-l3"><a class="reference internal" href="ziso.html">ziso</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../framework/index.html">Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../suites.html">Test suites</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../machines/index.html">Machines</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer's guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/quick_start.html">Quick Start for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/command_line.html">Command-line interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/organization.html">Organization of Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/landice/index.html">Landice core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/ocean/index.html">Ocean core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/framework.html">Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/machines/index.html">Machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/docs.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/building_docs.html">Building the Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/deploying_spack.html">Deploying a new spack environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../design_docs/index.html">Design Documents</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/dev_add_test_group.html">Developer Tutorial: Adding a new test group</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/dev_add_rrm.html">Developer Tutorial: Adding a new ocean/sea ice regionally refined mesh (RRM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/dev_add_param_study.html">Developer Tutorial: Adding a parameter study</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/dev_porting_legacy.html">Developer Tutorial: Porting a legacy COMPASS test group</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Glossary</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Versions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../versions.html">Code and Documentation Versions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">compass</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Ocean core</a></li>
          <li class="breadcrumb-item"><a href="index.html">Test groups</a></li>
      <li class="breadcrumb-item active">nonhydro</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/users_guide/ocean/test_groups/nonhydro.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="nonhydro">
<span id="ocean-nonhydro"></span><h1>nonhydro<a class="headerlink" href="#nonhydro" title="Link to this heading"></a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">ocean/nonhydro</span></code> test group implements test cases from
<a class="reference external" href="http://dx.doi.org/10.1016/j.ocemod.2014.08.008">Vitousek et al. (2014)</a>
to validate the nonhydrostatic capability of MPAS-O.</p>
<p>The test group includes 2 test cases. The first one describes a
continuously-stratified internal seiche and is presented in section 5.3
in Vitousek et al. (2014). The second one describes internal solitary
waves and is presented in section 5.5. All test cases have 4 steps:
<code class="docutils literal notranslate"><span class="pre">initial_state</span></code>, which defines the mesh and initial conditions for the model,
<code class="docutils literal notranslate"><span class="pre">hydro</span></code>, which performs time integration of the standard hydrostatic
model, <code class="docutils literal notranslate"><span class="pre">nonhydro</span></code>, which performs time integration of the nonhydrostaic
version of MPAS-O, and finally <code class="docutils literal notranslate"><span class="pre">visualize</span></code>, which compares the solutions
obtained with the hydrostatic and nonhydrostatic model.</p>
<section id="stratified-seiche">
<h2>stratified_seiche<a class="headerlink" href="#stratified-seiche" title="Link to this heading"></a></h2>
<p>The domain is a 10mx10m box discretized in the horizontal with 64 cells and
in the vertical with 100 layers. The initial density depends on the hyperbolic
tangent of an internal cosine wave, and density contours are localized at the
stratified interface. The set config options for this test case are:</p>
<div class="highlight-cfg notranslate"><div class="highlight"><pre><span></span><span class="c1"># config options for the horizontal grid</span>
<span class="k">[horizontal_grid]</span>

<span class="c1">#Number of cells in the x-direction</span>
<span class="na">nx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">64</span>

<span class="c1">#Number of cells in the y-direction</span>
<span class="na">ny</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">4</span>

<span class="c1">#Distance from two cell centers</span>
<span class="na">dc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0.15625</span>

<span class="c1"># config options for the seiche testcase</span>
<span class="k">[stratified_seiche]</span>

<span class="c1">#Depth of the bottom of the ocean</span>
<span class="na">maxDepth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16.0</span>

<span class="c1">#Number of vertical levels</span>
<span class="na">nVertLevels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">100</span>

<span class="c1">#Alpha in eos</span>
<span class="na">eos_linear_alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0.2</span>

<span class="c1">#Beta in eos</span>
<span class="na">eos_linear_beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0.8</span>

<span class="c1">#Reference temperature</span>
<span class="na">eos_linear_Tref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">10.0</span>

<span class="c1">#Reference salinity</span>
<span class="na">eos_linear_Sref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">35.0</span>

<span class="c1">#Reference density</span>
<span class="na">eos_linear_densityref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1000.0</span>

<span class="c1">#Density difference</span>
<span class="na">deltaRho</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">10.0</span>

<span class="c1">#Interface thickness</span>
<span class="na">interfaceThick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1.0</span>

<span class="c1">#Wave amplitude</span>
<span class="na">amplitude</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0.1</span>

<span class="c1">#Wavenumber</span>
<span class="na">wavenumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0.314159265358979</span>
</pre></div>
</div>
<p>The hydrostatic and nonhydrostatic simulations are run for one period
(50s) using RK4 with a time-step of 0.01s. A plot is produced at time
t = 12s showing the horizontal and vertical velocity profiles
normalized by their respective maxima at locations x=5m and x=0m,
respectively. The nonhydrostatic profiles coincide with first-mode
linearized eigenfunction analysis for this kind of problem presented
in <a class="reference external" href="https://doi.org/10.1017/S0022112003006189">Fringer et al. (2003)</a></p>
</section>
<section id="internal-wave">
<h2>internal_wave<a class="headerlink" href="#internal-wave" title="Link to this heading"></a></h2>
<p>This test case approximates the evolution of solitary-like waves in the
South China Sea. The domain has a length L of 300 km and depth H of
2000 m, and it discretized with 1200 cells in the horizontal and 100
layers in the vertical. The initial density depends on the hyperbolic
tangent of a Gaussian depression, and then evolves into a train of
solitary-like waves. The set config options for this test case are:</p>
<div class="highlight-cfg notranslate"><div class="highlight"><pre><span></span><span class="c1"># config options for the horizontal grid</span>
<span class="k">[horizontal_grid]</span>

<span class="c1">#Number of cells in the x-direction</span>
<span class="na">nx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1200</span>

<span class="c1">#Number of cells in the y-direction</span>
<span class="na">ny</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">4</span>

<span class="c1">#Distance from two cell centers</span>
<span class="na">dc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">250.0</span>

<span class="c1"># config options for the solitary wave testcase</span>
<span class="k">[solitary_wave]</span>

<span class="c1">#Depth of the bottom of the ocean</span>
<span class="na">maxDepth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">2000.0</span>

<span class="c1">#Number of vertical levels</span>
<span class="na">nVertLevels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">100</span>

<span class="c1">#Alpha in eos</span>
<span class="na">eos_linear_alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0.2</span>

<span class="c1">#Beta in eos</span>
<span class="na">eos_linear_beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0.8</span>

<span class="c1">#Reference temperature</span>
<span class="na">eos_linear_Tref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">10.0</span>

<span class="c1">#Reference salinity</span>
<span class="na">eos_linear_Sref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">35.0</span>

<span class="c1">#Reference density</span>
<span class="na">eos_linear_densityref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1000.0</span>

<span class="c1">#Upper-layer depth</span>
<span class="na">h1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">250.0</span>

<span class="c1">#Density difference</span>
<span class="na">deltaRho</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1.0</span>

<span class="c1">#Wave interface thickness</span>
<span class="na">interfaceThick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">200.0</span>

<span class="c1">#Wave amplitude</span>
<span class="na">amplitude</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">250.0</span>

<span class="c1">#Wavelenght</span>
<span class="na">wavelenght</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">15000.0</span>
</pre></div>
</div>
<p>The hydrostatic and nonhydrostatic simulations are run for 40h
using split-explicit with a baroclinic time-step of 1min and a
barotropic time-step of 1s. A plot at 40h is produced and shows
that the nonhydrostatic result leads to a train of rank-ordered
solitary-like internal gravity waves, whereas the hydrostatic model
fails to capture correct physics.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="merry_go_round.html" class="btn btn-neutral float-left" title="merry_go_round" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="overflow.html" class="btn btn-neutral float-right" title="overflow" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Copyright (c) 2013-2021,  Los Alamos National Security, LLC (LANS) (Ocean: LA-CC-13-047;Land Ice: LA-CC-13-117) and the University Corporation for Atmospheric Research (UCAR)..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>