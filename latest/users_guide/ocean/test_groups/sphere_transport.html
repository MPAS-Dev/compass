

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>sphere_transport &mdash; compass latest documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=c6e86fd7"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="spherical_harmonic_transform" href="spherical_harmonic_transform.html" />
    <link rel="prev" title="soma" href="soma.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            compass
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User's guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../quick_start.html">Quick Start for Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../test_cases.html">Test Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../config_files.html">Config Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../test_suites.html">Test Suites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../landice/index.html">Landice core</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Ocean core</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Test groups</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="baroclinic_channel.html">baroclinic_channel</a></li>
<li class="toctree-l3"><a class="reference internal" href="baroclinic_gyre.html">baroclinic_gyre</a></li>
<li class="toctree-l3"><a class="reference internal" href="buttermilk_bay.html">buttermilk_bay</a></li>
<li class="toctree-l3"><a class="reference internal" href="dam_break.html">dam_break</a></li>
<li class="toctree-l3"><a class="reference internal" href="drying_slope.html">drying_slope</a></li>
<li class="toctree-l3"><a class="reference internal" href="global_convergence.html">global_convergence</a></li>
<li class="toctree-l3"><a class="reference internal" href="global_ocean.html">global_ocean</a></li>
<li class="toctree-l3"><a class="reference internal" href="gotm.html">gotm</a></li>
<li class="toctree-l3"><a class="reference internal" href="hurricane.html">hurricane</a></li>
<li class="toctree-l3"><a class="reference internal" href="ice_shelf_2d.html">ice_shelf_2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="internal_wave.html">internal_wave</a></li>
<li class="toctree-l3"><a class="reference internal" href="isomip_plus.html">isomip_plus</a></li>
<li class="toctree-l3"><a class="reference internal" href="lock_exchange.html">lock_exchange</a></li>
<li class="toctree-l3"><a class="reference internal" href="merry_go_round.html">merry_go_round</a></li>
<li class="toctree-l3"><a class="reference internal" href="nonhydro.html">nonhydro</a></li>
<li class="toctree-l3"><a class="reference internal" href="overflow.html">overflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="parabolic_bowl.html">parabolic_bowl</a></li>
<li class="toctree-l3"><a class="reference internal" href="planar_convergence.html">planar_convergence</a></li>
<li class="toctree-l3"><a class="reference internal" href="soma.html">soma</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">sphere_transport</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rotation-2d">rotation_2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nondivergent-2d">nondivergent_2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="#divergent-2d">divergent_2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="#correlated-tracers-2d">correlated_tracers_2d</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spherical_harmonic_transform.html">spherical_harmonic_transform</a></li>
<li class="toctree-l3"><a class="reference internal" href="tides.html">tides</a></li>
<li class="toctree-l3"><a class="reference internal" href="utility.html">utility</a></li>
<li class="toctree-l3"><a class="reference internal" href="ziso.html">ziso</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../framework/index.html">Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../suites.html">Test suites</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../machines/index.html">Machines</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer's guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/quick_start.html">Quick Start for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/command_line.html">Command-line interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/organization.html">Organization of Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/landice/index.html">Landice core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/ocean/index.html">Ocean core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/framework.html">Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/machines/index.html">Machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/docs.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/building_docs.html">Building the Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/deploying_spack.html">Deploying a new spack environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../design_docs/index.html">Design Documents</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/dev_add_test_group.html">Developer Tutorial: Adding a new test group</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/dev_add_rrm.html">Developer Tutorial: Adding a new ocean/sea ice regionally refined mesh (RRM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/dev_add_param_study.html">Developer Tutorial: Adding a parameter study</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/dev_porting_legacy.html">Developer Tutorial: Porting a legacy COMPASS test group</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Glossary</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Versions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../versions.html">Code and Documentation Versions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">compass</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Ocean core</a></li>
          <li class="breadcrumb-item"><a href="index.html">Test groups</a></li>
      <li class="breadcrumb-item active">sphere_transport</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/users_guide/ocean/test_groups/sphere_transport.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="sphere-transport">
<span id="ocean-sphere-transport"></span><h1>sphere_transport<a class="headerlink" href="#sphere-transport" title="Link to this heading"></a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">sphere_transport</span></code> test group implements 4 test cases for standard
transport schemes.   The test cases are convergence studies on the full globe,
similar to <a class="reference internal" href="global_convergence.html#ocean-global-convergence"><span class="std std-ref">global_convergence</span></a>. Most tests are from
<a class="reference external" href="https://gmd.copernicus.org/articles/5/887/2012/">Lauritzen et al. (2012)</a>.</p>
<p>All test-case results include solution plots for each resolution and
convergence plots. Convergence data and mass conservation error is written to
<code class="docutils literal notranslate"><span class="pre">analysis.log</span></code> in csv format for each test case.</p>
<p>The test cases use MPAS’s <code class="docutils literal notranslate"><span class="pre">debugTracers</span></code> to define 3 tracers.   In all cases
except CorrelatedTracers2D (discussed below), the 3 tracers are:</p>
<ul class="simple">
<li><p>Tracer1: A c-infinity function used for convergence analysis</p></li>
<li><p>Tracer2: A pair of c-2 cosine bells</p></li>
<li><p>Tracer3: A discontinuous pair of slotted cylinders</p></li>
</ul>
<a class="reference internal image-reference" href="../../../_images/sphere_transport.png"><img alt="../../../_images/sphere_transport.png" class="align-center" src="../../../_images/sphere_transport.png" style="width: 500px;" />
</a>
<section id="rotation-2d">
<span id="ocean-sphere-transport-rotation-2d"></span><h2>rotation_2d<a class="headerlink" href="#rotation-2d" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">rotation_2d</span></code> test case has the simplest velocity field: rigid rotation
about an axis offset from the z-axis of the sphere.  It is the only test case
not from Lauritzen et al. (2012).</p>
<section id="config-options">
<h3>config options<a class="headerlink" href="#config-options" title="Link to this heading"></a></h3>
<p>Here, we give config options for the <code class="docutils literal notranslate"><span class="pre">rotation_2d</span></code> test case.  Config options
for the other test cases are nearly identical:</p>
<div class="highlight-cfg notranslate"><div class="highlight"><pre><span></span><span class="c1"># options for rotation2D convergence test case</span>
<span class="k">[rotation_2d]</span>

<span class="c1"># a list of resolutions (km) to test</span>
<span class="na">resolutions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">60, 90, 120, 150, 180, 240</span>

<span class="c1"># time step in minutes (1-1 with resolutions)</span>
<span class="na">timestep_minutes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">8, 12, 16, 20, 24, 32</span>

<span class="c1"># the number of cells per core to aim for</span>
<span class="na">goal_cells_per_core</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">300</span>

<span class="c1"># the approximate maximum number of cells per core (the test will fail if too</span>
<span class="c1"># few cores are available)</span>
<span class="na">max_cells_per_core</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">3000</span>

<span class="c1"># time integrator (RK4 or split_explicit)</span>
<span class="na">time_integrator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">RK4</span>

<span class="c1"># convergence threshold below which the test fails</span>
<span class="na">tracer1_conv_thresh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1.4</span>
<span class="na">tracer2_conv_thresh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1.8</span>
<span class="na">tracer3_conv_thresh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0.4</span>
</pre></div>
</div>
</section>
<section id="resolutions">
<h3>resolutions<a class="headerlink" href="#resolutions" title="Link to this heading"></a></h3>
<p>To alter the resolutions used in this test, you will need to create your own
config file (or add a <code class="docutils literal notranslate"><span class="pre">rotation_2d</span></code> section to a config file if you’re
already using one).  The resolutions are a comma-separated list of the
quasi-uniform resolution of the mesh in km.  If you specify a different list
before setting up <code class="docutils literal notranslate"><span class="pre">rotation_2d</span></code>, steps will be generated with the requested
resolutions.  (If you alter <code class="docutils literal notranslate"><span class="pre">resolutions</span></code> in the test case’s config file in
the work directory, nothing will happen.)</p>
</section>
<section id="time-step">
<h3>time step<a class="headerlink" href="#time-step" title="Link to this heading"></a></h3>
<p>For each resolution, the time step in minutes is provided in
<code class="docutils literal notranslate"><span class="pre">timestep_minutes</span></code>.  You can alter this before setup (in a user config file)
or before running the test case (in the config file in the work directory).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">time_integrator</span></code> config option determines whether 4th-order Runge-Kutta
(<cite>RK4</cite>) or split-explicit (<cite>split_explicit</cite>) time integration is performed.</p>
</section>
<section id="cores">
<h3>cores<a class="headerlink" href="#cores" title="Link to this heading"></a></h3>
<p>The number of cores (and the minimum) is proportional to the number of cells,
so that the number of cells per core is roughly constant.  You can alter how
many cells are allocated to each core with <code class="docutils literal notranslate"><span class="pre">goal_cells_per_core</span></code>.  You can
control the maximum number of cells that are allowed to be placed on a single
core (before the test case will fail) with <code class="docutils literal notranslate"><span class="pre">max_cells_per_core</span></code>.  If there
aren’t enough processors to handle the finest resolution, you will see that
the step (and therefore the test case) has failed.</p>
</section>
<section id="convergence-thresholds">
<h3>convergence thresholds<a class="headerlink" href="#convergence-thresholds" title="Link to this heading"></a></h3>
<p>The three convergence thresholds are used to determine if the error in each of
the tracers converges at the expected rate.  If a linear fit to the error as
a function of resolution has a slope that is shallower than the specified
value, the test case will fail, raising an error.  The idea is to detect
changes in the code that appreciably degrade performance of tracer transport.
If you change the resolutions used in the test case, you may need to adjust
these thresholds.</p>
</section>
</section>
<section id="nondivergent-2d">
<span id="ocean-sphere-transport-nondivergent-2d"></span><h2>nondivergent_2d<a class="headerlink" href="#nondivergent-2d" title="Link to this heading"></a></h2>
<p>Results from the <code class="docutils literal notranslate"><span class="pre">nondivergent_2d</span></code> test case also include the “filament norm”
and over-/under-shoot analysis.  The reversing deformational flow in this
test case explores large-scale to small-scale transport.</p>
</section>
<section id="divergent-2d">
<span id="ocean-sphere-transport-divergent-2d"></span><h2>divergent_2d<a class="headerlink" href="#divergent-2d" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">divergent_2d</span></code> test case analyzes transport scheme with a velocity field
that has nonzero divergence.</p>
</section>
<section id="correlated-tracers-2d">
<span id="ocean-sphere-transport-correlated-tracers-2d"></span><h2>correlated_tracers_2d<a class="headerlink" href="#correlated-tracers-2d" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">correlated_tracers_2d</span></code> test case uses the velocity as
<a class="reference internal" href="#ocean-sphere-transport-nondivergent-2d"><span class="std std-ref">nondivergent_2d</span></a>, but instead of slotted cylinders
in the 3rd tracer, adds a second pair of cosine bells that are nonlinearly
correlated with tracer2.  This tests the ability of the transport schemes to
maintain such a correlation.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="soma.html" class="btn btn-neutral float-left" title="soma" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="spherical_harmonic_transform.html" class="btn btn-neutral float-right" title="spherical_harmonic_transform" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Copyright (c) 2013-2021,  Los Alamos National Security, LLC (LANS) (Ocean: LA-CC-13-047;Land Ice: LA-CC-13-117) and the University Corporation for Atmospheric Research (UCAR)..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>