

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>spherical_harmonic_transform &mdash; compass latest documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=c6e86fd7"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="tides" href="tides.html" />
    <link rel="prev" title="sphere_transport" href="sphere_transport.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            compass
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User's guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../quick_start.html">Quick Start for Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../test_cases.html">Test Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../config_files.html">Config Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../test_suites.html">Test Suites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../landice/index.html">Landice core</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Ocean core</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Test groups</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="baroclinic_channel.html">baroclinic_channel</a></li>
<li class="toctree-l3"><a class="reference internal" href="baroclinic_gyre.html">baroclinic_gyre</a></li>
<li class="toctree-l3"><a class="reference internal" href="buttermilk_bay.html">buttermilk_bay</a></li>
<li class="toctree-l3"><a class="reference internal" href="dam_break.html">dam_break</a></li>
<li class="toctree-l3"><a class="reference internal" href="drying_slope.html">drying_slope</a></li>
<li class="toctree-l3"><a class="reference internal" href="global_convergence.html">global_convergence</a></li>
<li class="toctree-l3"><a class="reference internal" href="global_ocean.html">global_ocean</a></li>
<li class="toctree-l3"><a class="reference internal" href="gotm.html">gotm</a></li>
<li class="toctree-l3"><a class="reference internal" href="hurricane.html">hurricane</a></li>
<li class="toctree-l3"><a class="reference internal" href="ice_shelf_2d.html">ice_shelf_2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="internal_wave.html">internal_wave</a></li>
<li class="toctree-l3"><a class="reference internal" href="isomip_plus.html">isomip_plus</a></li>
<li class="toctree-l3"><a class="reference internal" href="lock_exchange.html">lock_exchange</a></li>
<li class="toctree-l3"><a class="reference internal" href="merry_go_round.html">merry_go_round</a></li>
<li class="toctree-l3"><a class="reference internal" href="nonhydro.html">nonhydro</a></li>
<li class="toctree-l3"><a class="reference internal" href="overflow.html">overflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="parabolic_bowl.html">parabolic_bowl</a></li>
<li class="toctree-l3"><a class="reference internal" href="planar_convergence.html">planar_convergence</a></li>
<li class="toctree-l3"><a class="reference internal" href="soma.html">soma</a></li>
<li class="toctree-l3"><a class="reference internal" href="sphere_transport.html">sphere_transport</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">spherical_harmonic_transform</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#qu-convergence">qu_convergence</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tides.html">tides</a></li>
<li class="toctree-l3"><a class="reference internal" href="utility.html">utility</a></li>
<li class="toctree-l3"><a class="reference internal" href="ziso.html">ziso</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../framework/index.html">Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../suites.html">Test suites</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../machines/index.html">Machines</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer's guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/quick_start.html">Quick Start for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/command_line.html">Command-line interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/organization.html">Organization of Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/landice/index.html">Landice core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/ocean/index.html">Ocean core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/framework.html">Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/machines/index.html">Machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/docs.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/building_docs.html">Building the Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/deploying_spack.html">Deploying a new spack environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../design_docs/index.html">Design Documents</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/dev_add_test_group.html">Developer Tutorial: Adding a new test group</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/dev_add_rrm.html">Developer Tutorial: Adding a new ocean/sea ice regionally refined mesh (RRM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/dev_add_param_study.html">Developer Tutorial: Adding a parameter study</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/dev_porting_legacy.html">Developer Tutorial: Porting a legacy COMPASS test group</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Glossary</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Versions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../versions.html">Code and Documentation Versions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">compass</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Ocean core</a></li>
          <li class="breadcrumb-item"><a href="index.html">Test groups</a></li>
      <li class="breadcrumb-item active">spherical_harmonic_transform</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/users_guide/ocean/test_groups/spherical_harmonic_transform.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="spherical-harmonic-transform">
<span id="ocean-spherical-harmonic-transform"></span><h1>spherical_harmonic_transform<a class="headerlink" href="#spherical-harmonic-transform" title="Link to this heading"></a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">spherical_harmonic_transform</span></code> test group implements test cases
for the spherical harmonic transformation implementations in
MPAS-Ocean. These tests involve computing the forward and inverse spherical
harmonic transform of a certain order for an analytical function.
The truncation errors for each order are compared with the analytical
function.</p>
<p>For ocean simulations, the spherical harmonic transformation capability
is used to compute the self attraction and loading forcing for tides.</p>
<p>Two different implementations are used in this test group:</p>
<ul class="simple">
<li><p>The first is a “serial” algorithm which involves an interpolation
from the MPAS mesh to a Guassian grid and  then uses a fast shperical
harmonic library, SHTns, to compute the forward and inverse
transformations. The approximate function is then interpolated back
to the MPAS mesh.
Since the SHTns library dosen’t use distributed memory parallelism,
the function values are first gathered onto a single MPI rank that
is responsible for the interpolation and forward and inverse
transformations. Finally, a scatter is performed to return the local
approximate function values to each core.</p></li>
<li><p>The second implimentation is a “parallel” algoritm which does not use
a fast library, but instead computes the spherical harmonic transform
directly on the unstructured mesh using an MPI All_Reduce.</p></li>
</ul>
<p>In order for this test case to run properly for the “serial” algorithm,
MPAS-Ocean must be compiled with the <code class="docutils literal notranslate"><span class="pre">USE_SHTNS=true</span></code> and
<code class="docutils literal notranslate"><span class="pre">OPENMP=false</span></code> options.</p>
<p>The test group includes 1 test case with 3 steps:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mesh</span></code> creates a quasi uniform MPAS mesh on the sphere</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">init</span></code> runs MPAS-Ocean init mode to compute the shperical harmonic
transformations</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">analysis</span></code> reads the error values from the MPAS log files and
generates a convergence plot which will look like the image below:</p></li>
</ul>
<a class="reference internal image-reference" href="../../../_images/spherical_harmonic_transform_convergence.png"><img alt="../../../_images/spherical_harmonic_transform_convergence.png" class="align-center" src="../../../_images/spherical_harmonic_transform_convergence.png" style="width: 500px;" />
</a>
<section id="qu-convergence">
<span id="ocean-spherical-harmonic-transform-qu-convergence"></span><h2>qu_convergence<a class="headerlink" href="#qu-convergence" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">qu_convergence</span></code> test case uses quasi-uniform meshes and an analyitical
function that is a sprial:</p>
<a class="reference internal image-reference" href="../../../_images/spherical_harmonic_transform_qu_function.png"><img alt="../../../_images/spherical_harmonic_transform_qu_function.png" class="align-center" src="../../../_images/spherical_harmonic_transform_qu_function.png" style="width: 500px;" />
</a>
<section id="config-options">
<h3>config options<a class="headerlink" href="#config-options" title="Link to this heading"></a></h3>
<p>Here, we give config options for the <code class="docutils literal notranslate"><span class="pre">qu_convergence</span></code> test case.</p>
<div class="highlight-cfg notranslate"><div class="highlight"><pre><span></span><span class="c1"># options for the QU mesh convergence test case for spherical harmonic transforms</span>
<span class="k">[qu_convergence]</span>

<span class="c1"># a list of resolutions to test</span>
<span class="na">resolutions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">60, 30</span>

<span class="c1"># a list of spherical harmoic orders to test for the parallel algorithm</span>
<span class="na">parallel_N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">18, 26, 29, 35, 60</span>

<span class="c1"># a list of Gaussian grid resolutions (number of latitudes) for the serial algorithm</span>
<span class="na">serial_nLat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">40, 64, 92, 220, 980</span>
</pre></div>
</div>
</section>
<section id="resolutions">
<h3>resolutions<a class="headerlink" href="#resolutions" title="Link to this heading"></a></h3>
<p>To alter the resolutions used in this test, you will need to create your own
config file (or add a <code class="docutils literal notranslate"><span class="pre">qu_convergence</span></code> section to a config file if you’re
already using one).  The resolutions are a comma-separated list of the
quasi-uniform resolution of the mesh in km.  If you specify a different list
before setting up <code class="docutils literal notranslate"><span class="pre">qu_convergence</span></code>, steps will be generated with the requested
resolutions.  (If you alter <code class="docutils literal notranslate"><span class="pre">resolutions</span></code> in the test case’s config file in
the work directory, nothing will happen.)</p>
</section>
<section id="parallel-n">
<h3>parallel_N<a class="headerlink" href="#parallel-n" title="Link to this heading"></a></h3>
<p>For each resolution, the spherial harmonic orders for the parallel algorithm
are specified as a comma separated list for the <code class="docutils literal notranslate"><span class="pre">parallel_N</span></code> option.
You can alter this before setup (in a user config file)
or before running the test case (in the config file in the work directory).</p>
</section>
<section id="serial-nlat">
<h3>serial_nLat<a class="headerlink" href="#serial-nlat" title="Link to this heading"></a></h3>
<p>For each resolution, the number of latitudes in the Gaussian grid for
the serial algorithm are specified as a comma separated list for the
<code class="docutils literal notranslate"><span class="pre">serial_nLat</span></code> option.  This is related to the spherical harmonic order
by: N = nLat/2 - 1. You can alter this before setup (in a user config file)
or before running the test case (in the config file in the work directory).</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="sphere_transport.html" class="btn btn-neutral float-left" title="sphere_transport" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tides.html" class="btn btn-neutral float-right" title="tides" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Copyright (c) 2013-2021,  Los Alamos National Security, LLC (LANS) (Ocean: LA-CC-13-047;Land Ice: LA-CC-13-117) and the University Corporation for Atmospheric Research (UCAR)..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>